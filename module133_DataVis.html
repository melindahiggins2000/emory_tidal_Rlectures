<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">

<head>

<meta charset="utf-8" />
<meta name="generator" content="quarto-1.6.39" />

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />


<title>1.3.3: Data Visualization – R Training - TIDAL Lectures</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<!-- htmldependencies:E3FAD763 -->
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link href="site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet" />
<script src="site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="site_libs/plotly-binding-4.10.4/plotly.js"></script>
<script src="site_libs/typedarray-0.1/typedarray.min.js"></script>
<script src="site_libs/jquery-3.5.1/jquery.min.js"></script>
<link href="site_libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet" />
<script src="site_libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
<link href="site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="site_libs/plotly-main-2.11.1/plotly-latest.min.js"></script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn"
      data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" 
      aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation"
      onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <h1 class="quarto-secondary-nav-title no-breadcrumbs"></h1>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" role="link"
        aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation"
        onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-center sidebar-header">
      <a href="/index.html" class="sidebar-logo-link">
      <img src="/tidal_logo.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none"/>
      </a>
      <div class="sidebar-tools-main">
    <a href="https://www.project-tidal.org/"  title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-house-fill"></i></a>
    <a href="https://github.com/melindahiggins2000/emory_tidal_Rlectures"  title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-github"></i></a>
</div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Home</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="/module131_IntroRRStudio.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">1.3.1: Introduction to R and R Studio</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="/module132_DataWrangling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">1.3.2: Data Wrangling</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="/module133_DataVis.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">1.3.3: Data Visualization</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="/module134_MissingWeight.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">1.3.4: Missing Data and Sampling Weights</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="/module135_StatisticalTests.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">1.3.5: Statistical Tests and Models</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="/module136_ReproducibleResearch.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">1.3.6: Reproducible Research Principles</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="/PRAMS.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">PRAMS Data Analysis</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="/additionalResources.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Additional Help and Resources</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" ></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <div id="quarto-toc-target"></div>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">1.3.3: Data Visualization</h1>
<p class="subtitle lead">(Asynchronous-Online)</p>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>

<nav id="TOC" role="doc-toc">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#session-objectives" id="toc-session-objectives">Session Objectives</a></li>
  <li><a href="#prework---before-you-begin" id="toc-prework---before-you-begin">0. Prework - Before You Begin</a>
  <ul>
  <li><a href="#a.-install-packages" id="toc-a.-install-packages">A. Install packages</a></li>
  <li><a href="#b.-opencreate-your-rstudio-project" id="toc-b.-opencreate-your-rstudio-project">B. Open/create your RStudio project</a></li>
  <li><a href="#c.-create-a-new-r-script-and-load-data-into-your-computing-session" id="toc-c.-create-a-new-r-script-and-load-data-into-your-computing-session">C. Create a new R script and load data into your computing session</a></li>
  <li><a href="#d.-get-inspired" id="toc-d.-get-inspired">D. Get Inspired!</a></li>
  </ul></li>
  <li><a href="#base-r-graphical-functions" id="toc-base-r-graphical-functions">1. Base R graphical functions</a>
  <ul>
  <li><a href="#base-r---scatterplot" id="toc-base-r---scatterplot">Base R - Scatterplot</a></li>
  <li><a href="#base-r---histogram" id="toc-base-r---histogram">Base R - Histogram</a>
  <ul>
  <li><a href="#basic-histogram" id="toc-basic-histogram"><strong>Basic Histogram</strong></a></li>
  <li><a href="#histogram-with-overlaid-density-curve" id="toc-histogram-with-overlaid-density-curve"><strong>Histogram with Overlaid Density Curve</strong></a></li>
  <li><a href="#fix-the-heights" id="toc-fix-the-heights"><strong>Fix the Heights</strong></a></li>
  </ul></li>
  <li><a href="#base-r---barchart" id="toc-base-r---barchart">Base R - Barchart</a></li>
  <li><a href="#base-r---boxplot" id="toc-base-r---boxplot">Base R - Boxplot</a></li>
  </ul></li>
  <li><a href="#the-ggplot2-package" id="toc-the-ggplot2-package">2. The <code>ggplot2</code> package</a>
  <ul>
  <li><a href="#ggplot2---scatterplot" id="toc-ggplot2---scatterplot"><code>ggplot2</code> - Scatterplot</a></li>
  <li><a href="#ggplot2---histogram" id="toc-ggplot2---histogram"><code>ggplot2</code> - Histogram</a></li>
  <li><a href="#ggplot2---boxplot-and-variations" id="toc-ggplot2---boxplot-and-variations"><code>ggplot2</code> - Boxplot (and variations)</a></li>
  <li><a href="#ggplot2---barchart" id="toc-ggplot2---barchart"><code>ggplot2</code> - Barchart</a></li>
  <li><a href="#ggplot2---errorbar-plots" id="toc-ggplot2---errorbar-plots"><code>ggplot2</code> - Errorbar plots</a></li>
  <li><a href="#ggplot2---lollipop-plots" id="toc-ggplot2---lollipop-plots"><code>ggplot2</code> - Lollipop plots</a></li>
  </ul></li>
  <li><a href="#other-graphics-packages-to-know" id="toc-other-graphics-packages-to-know">3. Other Graphics Packages to Know</a>
  <ul>
  <li><a href="#save-plot-objects-and-reuserearrange-them" id="toc-save-plot-objects-and-reuserearrange-them">Save plot objects and reuse/rearrange them</a>
  <ul>
  <li><a href="#patchwork-package" id="toc-patchwork-package"><strong><code>patchwork</code> package</strong></a></li>
  <li><a href="#ggpubr-package-and-ggarrange-function" id="toc-ggpubr-package-and-ggarrange-function"><strong><code>ggpubr</code> package and <code>ggarrange()</code> function</strong></a></li>
  </ul></li>
  <li><a href="#ggally-package-and-ggpairs-function" id="toc-ggally-package-and-ggpairs-function"><code>GGally</code> package and <code>ggpairs()</code> function</a></li>
  <li><a href="#visualize-categorical-data-with-vcd-package" id="toc-visualize-categorical-data-with-vcd-package">Visualize Categorical Data with <code>vcd</code> package</a></li>
  <li><a href="#example-of-an-animated-graph-with-gganimate" id="toc-example-of-an-animated-graph-with-gganimate">Example of an animated graph with <code>gganimate</code></a></li>
  <li><a href="#interactive-graphics-with-plotly" id="toc-interactive-graphics-with-plotly">Interactive Graphics with <code>plotly</code></a></li>
  </ul></li>
  <li><a href="#summary-tables-with-graphics" id="toc-summary-tables-with-graphics">4. Summary Tables with Graphics</a></li>
  <li><a href="#other-places-to-get-help-and-get-started" id="toc-other-places-to-get-help-and-get-started">5. Other Places to Get Help and Get Started</a></li>
  <li><a href="#r-code-for-this-module" id="toc-r-code-for-this-module">R Code For This Module</a></li>
  <li><a href="#references" id="toc-references">References</a></li>
  <li><a href="#other-helpful-resources" id="toc-other-helpful-resources">Other Helpful Resources</a></li>
  </ul>
</nav>
<section id="session-objectives" class="level2">
<h2>Session Objectives</h2>
<ol type="1">
<li>To visualize data using different R packages.</li>
</ol>
<p>This lesson module will include:</p>
<ul>
<li>Introductions to <code>ggplot2</code> and other relevant R packages for graphics.</li>
<li>Visualizing one, two, and more variables at a time.</li>
<li>Summary Tables with Graphics</li>
<li>Lists of other resources: books, blogs, websites, etc.</li>
</ul>
<hr />
</section>
<section id="prework---before-you-begin" class="level2">
<h2>0. Prework - Before You Begin</h2>
<section id="a.-install-packages" class="level3">
<h3>A. Install packages</h3>
<p>If you do not have them already, install the following packages from CRAN:</p>
<ul>
<li><a href="https://cloud.r-project.org/web/packages/ggplot2/"><code>ggplot2</code></a></li>
<li><a href="https://cloud.r-project.org/web/packages/dplyr/"><code>dplyr</code></a></li>
<li><a href="https://cran.r-project.org/web/packages/patchwork/"><code>patchwork</code></a></li>
<li><a href="https://cran.r-project.org/web/packages/ggpubr/"><code>ggpubr</code></a></li>
<li><a href="https://cran.r-project.org/web/packages/GGally/"><code>GGally</code></a></li>
<li><a href="https://cran.r-project.org/web/packages/vcd/"><code>vcd</code></a></li>
<li>Optional <a href="https://cran.r-project.org/web/packages/gapminder/"><code>gapminder</code></a></li>
<li>Optional <a href="https://cran.r-project.org/web/packages/gganimate/"><code>gganimate</code></a></li>
<li>Optional <a href="https://cran.r-project.org/web/packages/plotly/"><code>plotly</code></a></li>
<li>Optional <a href="https://cran.r-project.org/web/packages/gt/"><code>gt</code></a></li>
<li>Optional <a href="https://cran.r-project.org/web/packages/gtExtras/"><code>gtExtras</code></a></li>
</ul>
</section>
<section id="b.-opencreate-your-rstudio-project" class="level3">
<h3>B. Open/create your RStudio project</h3>
<p>Let’s start with the <code>myfirstRproject</code> RStudio project you created in <a href="module132_DataWrangling.html#begin-with-a-new-rstudio-project">Module 1.3.2 - part 1</a>. If you have not yet created this <code>myfirstRproject</code> RStudio project, go ahead and create a new RStudio Project for this lesson. <em>Feel free to name your project whatever you want, it does not need to be named <code>myfirstRproject</code>.</em></p>
</section>
<section id="c.-create-a-new-r-script-and-load-data-into-your-computing-session" class="level3">
<h3>C. Create a new R script and load data into your computing session</h3>
<p>At the end of <a href="module132_DataWrangling.html#save-mydata-as-.rdata-native-r-binary-format">Module 1.3.2 - part 6</a> you saved the <code>mydata</code> dataset in the <code>mydata.RData</code> R binary format.</p>
<ol type="1">
<li><p>Go ahead and create a new R script (<code>*.R</code>) for this computing session. <em>We did this already in <a href="module131_IntroRRStudio.html#create-your-first-r-script">Module 1.3.1 - part 3</a> - refer to this section to remember how to create a new R script.</em></p></li>
<li><p>Put this code into your new R script (<code>*.R</code>) to load <code>mydata.RData</code> into your current computing session.</p></li>
</ol>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load mydata</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="at">file =</span> <span class="st">&quot;mydata.RData&quot;</span>)</span></code></pre></div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class='callout-icon'></i>
</div>
<div class="callout-title-container flex-fill">
Data must/should be in your RStudio project
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>REMEMBER</strong> R/RStudio automatically looks in your current RStudio project folder for all files for your current computing session. So, make sure the <code>mydata.RData</code> file is in your current RStudio project <code>myfirstRproject</code> folder on your computer.</p>
<p>For a more detailed overview of RStudio projects:</p>
<ul>
<li>read <a href="https://epirhandbook.com/en/new_pages/r_projects.html">“Chapter 6: R projects” in the <em>The Epidemiologist R Handbook</em></a> and</li>
<li>refer to <a href="https://epirhandbook.com/en/new_pages/directories.html">“Chapter 45 Directory interactions” in the <em>The Epidemiologist R Handbook</em></a>.</li>
</ul>
</div>
</div>
</section>
<section id="d.-get-inspired" class="level3">
<h3>D. Get Inspired!</h3>
<ul>
<li>Get Inspired at <a href="https://r-graph-gallery.com/">The R Graph Gallery</a></li>
<li>Also see the <a href="https://r-graph-gallery.com/best-r-chart-examples">Top Curated R Graphs</a></li>
<li>Also see <a href="additionalResources.html#r-graphics">Additional Resources - R Graphics</a></li>
</ul>
<hr />
<div style="page-break-after: always;"></div>
</section>
</section>
<section id="base-r-graphical-functions" class="level2">
<h2>1. Base R graphical functions</h2>
<p>The base R <code>graphics</code> package is very powerful on its own. As you saw in <a href="module131_IntroRRStudio.html">1.3.1: Introduction to R and R Studio</a>, we can make a simple 2-dimensional scatterplot with the <code>plot()</code> function.</p>
<section id="base-r---scatterplot" class="level3">
<h3>Base R - Scatterplot</h3>
<p>For example, let’s make a plot of <code>Height</code> on the X-axis (horizontal) and <code>WeightPRE</code> on the Y-axis (vertical) from the <code>mydata</code> dataset. Since we are using base R function, we have to use the <code>$</code>selector to identify the variables we want inside the <code>mydata</code> dataset.</p>
<p>Learn more about the <code>plot()</code> function and arguments by running <code>help(plot, package = "graphics")</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> mydata<span class="sc">$</span>Height,</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">y =</span> mydata<span class="sc">$</span>WeightPRE)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure>
<p><img src="module133_DataVis_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="576" /></p>
</figure>
</div>
</div>
</div>
<p>The plot does look a little odd - this is due to some data errors in the <code>mydata</code> dataset. We will fix these below. But for now, you can “see” that these data may have some issues that need to be addressed. For example:</p>
<ul>
<li>There are 2 people with heights &lt; 5 feet tall which may be suspect</li>
<li>There are 2 people with a weight &lt; 100 pounds which may be data entry errors or incorrect units</li>
</ul>
<div style="page-break-after: always;"></div>
<p>For now, let’s add some additional graphical elements:</p>
<ul>
<li>a better label for the x-axis</li>
<li>a better label for the y-axis</li>
<li>a title for the graph</li>
<li>a subtitle for the graph</li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb3"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> mydata<span class="sc">$</span>Height,</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">y =</span> mydata<span class="sc">$</span>WeightPRE,</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Height (in decimal inches)&quot;</span>,</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Weight (in pounds) - before intervention&quot;</span>,</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Weight by Height in the Mydata Project&quot;</span>,</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">sub =</span> <span class="st">&quot;Hypothetical Madeup mydata Dataset&quot;</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure>
<p><img src="module133_DataVis_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="576" /></p>
</figure>
</div>
</div>
</div>
<div style="page-break-after: always;"></div>
<p>And we could also add color and change the shapes - for example, let’s color and shape the points by <code>GenderCoded</code>, the numeric coding for gender where 1=Male, 2=Female.</p>
<p>And we can add a legend inside the plot as well.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class='callout-icon'></i>
</div>
<div class="callout-title-container flex-fill">
Plot code inspiration
</div>
</div>
<div class="callout-body-container callout-body">
<p>I pulled this code together from code examples at:</p>
<ul>
<li><a href="https://stackoverflow.com/questions/12919816/plotting-in-different-shapes-using-pch-argument">Stackoverflow post on using <code>pch</code></a></li>
<li><a href="https://www.sthda.com/english/wiki/r-plot-pch-symbols-the-different-point-shapes-available-in-r">STHDA post on point shapes</a></li>
<li><a href="https://www.sthda.com/english/wiki/add-legends-to-plots-in-r-software-the-easiest-way">STDHA post on base R legends</a></li>
<li><a href="https://r-graph-gallery.com/119-add-a-legend-to-a-plot.html">R-Graph Galler post on base R legends</a></li>
</ul>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb4"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> mydata<span class="sc">$</span>Height,</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">y =</span> mydata<span class="sc">$</span>WeightPRE,</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;green&quot;</span>)[mydata<span class="sc">$</span>GenderCoded],</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">15</span>, <span class="dv">19</span>)[mydata<span class="sc">$</span>GenderCoded],</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Height (in decimal inches)&quot;</span>,</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Weight (in pounds) - before intervention&quot;</span>,</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Weight by Height in the Mydata Project&quot;</span>,</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">sub =</span> <span class="st">&quot;Hypothetical Madeup mydata Dataset&quot;</span>)</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="dv">3</span>, <span class="dv">250</span>, <span class="at">legend=</span><span class="fu">c</span>(<span class="st">&quot;Male&quot;</span>, <span class="st">&quot;Female&quot;</span>),</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;green&quot;</span>), <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">15</span>, <span class="dv">19</span>), <span class="at">cex=</span><span class="fl">0.8</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure>
<p><img src="module133_DataVis_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="576" /></p>
</figure>
</div>
</div>
</div>
<p>The <a href="https://www.sthda.com/english/wiki/r-base-graphs">STHDA website on “R Base Graphs”</a> has a nice walk through of using the base R <code>graphics</code> package to make really nice plots.</p>
<div style="page-break-after: always;"></div>
</section>
<section id="base-r---histogram" class="level3">
<h3>Base R - Histogram</h3>
<section id="basic-histogram" class="level4">
<h4><strong>Basic Histogram</strong></h4>
<p>As we noted above, let’s take a look at the distribution of the heights in the <code>mydata</code> dataset. There is a specific <code>hist()</code> function in the <code>graphics</code> package for making histograms, learn more by running <code>help(hist, package = "graphics")</code>.</p>
<p>Notice that we can use some of the same arguments as we did above for <code>plot()</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb5"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(mydata<span class="sc">$</span>Height,</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Height (in decimal inches)&quot;</span>,</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;lightblue&quot;</span>,</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">border =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Histogram of Heights&quot;</span>,</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">sub =</span> <span class="st">&quot;Hypothetical Madeup mydata Dataset&quot;</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure>
<p><img src="module133_DataVis_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="576" /></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class='callout-icon'></i>
</div>
<div class="callout-title-container flex-fill">
Colors available
</div>
</div>
<div class="callout-body-container callout-body">
<p>There are 657 names of colors immediately available to you from the built-in <code>grDevices</code> Base R package which works in conjunction with <code>graphics</code>. You can view the names of all of these colors by running <code>colors()</code>. You can also learn more at:</p>
<ul>
<li><a href="https://www.sthda.com/english/wiki/colors-in-r#google_vignette">https://www.sthda.com/english/wiki/colors-in-r#google_vignette</a></li>
<li><a href="https://r-graph-gallery.com/42-colors-names.html">https://r-graph-gallery.com/42-colors-names.html</a></li>
<li><a href="https://r-graph-gallery.com/ggplot2-color.html">https://r-graph-gallery.com/ggplot2-color.html</a> - which explains how colors can be specified using the built-in color names, but can also be specified using RGB (red, green, blue) indexes or even Hexcodes for which there are many online tools like <a href="https://htmlcolorcodes.com/">https://htmlcolorcodes.com/</a>.</li>
</ul>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb6"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># code not run here - do in your session</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co"># list built-in colors</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colors</span>()</span></code></pre></div>
</div>
<div style="page-break-after: always;"></div>
</section>
<section id="histogram-with-overlaid-density-curve" class="level4">
<h4><strong>Histogram with Overlaid Density Curve</strong></h4>
<p>Statisticians often like seeing a histogram <em>(for the frequencies or probability of each value for the variable in the dataset)</em> with an overlaid density curve <em>(which is “smoothed” line for these probabilities)</em>. Statistical software like SAS and SPSS make this really easy. However, in R, we need to think through the process to get this to work.</p>
<ul>
<li>First, we need to make the histogram using probabilities for the “bars” in the histogram instead of frequency counts.</li>
<li>Second, we need to add a density line curve over the histogram “bars”.</li>
</ul>
<p>See these online examples:</p>
<ul>
<li><a href="https://r-charts.com/distribution/histogram-curves/">https://r-charts.com/distribution/histogram-curves/</a></li>
<li><a href="https://www.datacamp.com/doc/r/histograms-and-density">https://www.datacamp.com/doc/r/histograms-and-density</a></li>
<li><a href="https://www.r-bloggers.com/2012/09/histogram-density-plot-combo-in-r/">https://www.r-bloggers.com/2012/09/histogram-density-plot-combo-in-r/</a></li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb7"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># make histogram as we did above</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="co"># add freq = FALSE</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(mydata<span class="sc">$</span>Height,</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">freq =</span> <span class="cn">FALSE</span>,</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Height (in decimal inches)&quot;</span>,</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;lightblue&quot;</span>,</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">border =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Histogram of Heights&quot;</span>,</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">sub =</span> <span class="st">&quot;Hypothetical Madeup mydata Dataset&quot;</span>)</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="co"># add density curve line</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="co"># add na.rm=TRUE to remove </span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="co"># the missing values in Height</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">density</span>(mydata<span class="sc">$</span>Height, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="st">&quot;black&quot;</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure>
<p><img src="module133_DataVis_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="576" /></p>
</figure>
</div>
</div>
</div>
<div style="page-break-after: always;"></div>
</section>
<section id="fix-the-heights" class="level4">
<h4><strong>Fix the Heights</strong></h4>
<p>So as you can see in the histogram and in the scatterplot figures above for the <code>Height</code> variable, there are 2 people with heights under 4 feet tall.</p>
<div class="cell">
<div class="sourceCode" id="cb8"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># use dplyr::arrange()</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>mydata <span class="sc">%&gt;%</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(SubjectID, Height) <span class="sc">%&gt;%</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Height) <span class="sc">%&gt;%</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 2
  SubjectID Height
      &lt;dbl&gt;  &lt;dbl&gt;
1        28    2.6
2         8    3.3
3         9    5.1
4         6    5.2
5         2    5.4
6        12    5.5</code></pre>
</div>
</div>
<p>Let’s look at these values:</p>
<ul>
<li><code>SubjectID</code> number 28 has a <code>Height</code> of 2.6 feet tall
<ul>
<li>If this wasn’t a made-up dataset, we could ask the original data collectors to see if there is a way to check this value in their records or possibly to re-measure this individual.</li>
<li>For now, let’s assume this was a simple typo where the 2 numbers were transposed where this individual should be 6.2 feet tall.</li>
</ul></li>
<li><code>SubjectID</code> number 8 has a <code>Height</code> of 3.3 feet tall
<ul>
<li>Unfortunately, this is probably not a simple typo. Without further details, we should maybe set this to missing as an invalidated data point.</li>
<li>As a side-note, I actually ran into this problem in a study where one of the participants was a paraplegic. So, this could be a legitimate height. But when computing BMI, adjustments need to be made or alternative body metrics are needed.</li>
<li>For now, we will set this to missing, <code>NA_real_</code> which is missing for “real” numeric variables.</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb10"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># make a copy of the dataset</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>mydata_corrected <span class="ot">&lt;-</span> mydata</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co"># compute a new corrected height</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="co"># fix heights for these 2 IDs</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>mydata_corrected <span class="ot">&lt;-</span> </span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  mydata_corrected <span class="sc">%&gt;%</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Height_corrected =</span> <span class="fu">case_when</span>(</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>    (SubjectID <span class="sc">==</span> <span class="dv">28</span>) <span class="sc">~</span> <span class="fl">6.2</span>,</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>    (SubjectID <span class="sc">==</span> <span class="dv">8</span>) <span class="sc">~</span> <span class="cn">NA_real_</span>,</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">.default =</span> Height</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>  ))</span></code></pre></div>
</div>
<div style="page-break-after: always;"></div>
<p>Remake the histogram with the corrected heights.</p>
<div class="cell">
<div class="sourceCode" id="cb11"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># make histogram as we did above</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="co"># add freq = FALSE</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(mydata_corrected<span class="sc">$</span>Height_corrected,</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">freq =</span> <span class="cn">FALSE</span>,</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Height (in decimal inches)&quot;</span>,</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;lightblue&quot;</span>,</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">border =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Histogram of Heights&quot;</span>,</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">sub =</span> <span class="st">&quot;Hypothetical Madeup mydata Dataset&quot;</span>)</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="co"># add density curve line</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a><span class="co"># add na.rm=TRUE to remove </span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a><span class="co"># the missing values in Height</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">density</span>(mydata_corrected<span class="sc">$</span>Height_corrected, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="st">&quot;black&quot;</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure>
<p><img src="module133_DataVis_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="576" /></p>
</figure>
</div>
</div>
</div>
<div style="page-break-after: always;"></div>
</section>
</section>
<section id="base-r---barchart" class="level3">
<h3>Base R - Barchart</h3>
<p>Let’s make a bar chart for the frequencies for the 3 SES categories:</p>
<ul>
<li>fill the bars with a yellow color specified by the HEX code <a href="https://www.color-hex.com/color/f7f445"><code>#f7f445</code></a></li>
<li>set the border color as <code>darkgreen</code> and make the border line thicker by updating the <code>lwd</code>, see <a href="https://stackoverflow.com/questions/8795862/width-of-edge-of-the-bars-in-r-plots">Stack Overflow Post on bar width</a>.</li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb12"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get table of frequencies for each category</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>tab1 <span class="ot">&lt;-</span> <span class="fu">table</span>(mydata_corrected<span class="sc">$</span>SES.f)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>opar <span class="ot">&lt;-</span> <span class="fu">par</span>() <span class="co"># save current plotting parameters</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">lwd =</span> <span class="dv">3</span>) <span class="co"># change border linewidth</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="co"># make plot of the frequencies for </span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="co"># each category</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(tab1,</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlab =</span> <span class="st">&quot;SES Categories&quot;</span>,</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab =</span> <span class="st">&quot;Frequencies&quot;</span>,</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="st">&quot;#f7f445&quot;</span>,</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">border =</span> <span class="st">&quot;darkgreen&quot;</span>,</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">&quot;Socio Economic Status Categories&quot;</span>,</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">sub =</span> <span class="st">&quot;Hypothetical Madeup mydata Dataset&quot;</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure>
<p><img src="module133_DataVis_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="576" /></p>
</figure>
</div>
</div>
<div class="sourceCode" id="cb13"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(opar) <span class="co"># reset plotting parameters to defaults</span></span></code></pre></div>
</div>
<div style="page-break-after: always;"></div>
</section>
<section id="base-r---boxplot" class="level3">
<h3>Base R - Boxplot</h3>
<p>Make side-by-side boxplots of the heights by gender.</p>
<div class="cell">
<div class="sourceCode" id="cb14"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(Height_corrected <span class="sc">~</span> GenderCoded.f,</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">data =</span> mydata_corrected,</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlab =</span> <span class="st">&quot;Gender&quot;</span>,</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab =</span> <span class="st">&quot;Height (in decimal feet)&quot;</span>,</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="st">&quot;#f58ef1&quot;</span>,</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">border =</span> <span class="st">&quot;darkmagenta&quot;</span>,</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">&quot;Height by Gender&quot;</span>,</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">sub =</span> <span class="st">&quot;Hypothetical Madeup mydata Dataset&quot;</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure>
<p><img src="module133_DataVis_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="576" /></p>
</figure>
</div>
</div>
</div>
<hr />
<div style="page-break-after: always;"></div>
</section>
</section>
<section id="the-ggplot2-package" class="level2">
<h2>2. The <code>ggplot2</code> package</h2>
<p>The <code>ggplot2</code> package name starts with <code>gg</code> which stands for the “grammar of graphics” which is explained in the <a href="https://ggplot2-book.org/introduction#what-is-the-grammar-of-graphics">“ggplot2: Elegant Graphics for Data Analysis (3e)” Book</a>.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class='callout-icon'></i>
</div>
<div class="callout-title-container flex-fill">
Why is the package <code>ggplot2</code> and not <code>ggplot</code>?
</div>
</div>
<div class="callout-body-container callout-body">
<p>Many people often ask Hadley Wickham (the developer of <code>ggplot2</code>) what happened to the first <code>ggplot</code>? Technically, there was a <code>ggplot</code> package and you can still view the <a href="https://cran.r-project.org/src/contrib/Archive/ggplot/"><code>ggplot</code> archived package versions on CRAN</a> which date back to 2006 with the last version posted in 2008. However, in 2007, Hadley redesigned the package and published the first version of <a href="https://cran.r-project.org/src/contrib/Archive/ggplot2/"><code>ggplot2</code> <em>(version 0.5.1)</em> was posted on CRAN</a>. So, <code>ggplot2</code> is the package that has stayed in production and actively maintained for nearly 20 years!!</p>
</div>
</div>
<p>Given that <code>ggplot2</code> has been actively maintained for nearly 20 years, it has become <em>almost</em> the defacto graphical standard for R graphics. If you take a look at the <a href="https://cran.r-project.org/web/packages/available_packages_by_name.html#available-packages-G">list of packages on CRAN that start with the letter “G”</a>, as of this morning <code>01/28/2025 at 8:23 am EST, USA</code>, there are 230 packages that start with <code>gg</code> - nearly all of these are compatible packages that extend the functionality or work in concert with the <code>ggplot2</code> package. There are also currently 14 packages on the <a href="https://www.bioconductor.org/packages/release/BiocViews.html#___Software">Bioconductor repository</a> that start with <code>gg</code>.</p>
<p>Let’s make plots similar to the ones above but now using <code>ggplot2</code>. When making a <code>ggplot2</code> plot, we build the plots using layers that get added to the previous layers.</p>
<div style="page-break-after: always;"></div>
<section id="ggplot2---scatterplot" class="level3">
<h3><code>ggplot2</code> - Scatterplot</h3>
<p>Here are the steps to building a scatterplot.</p>
<ol type="1">
<li>First, load the <code>ggplot2</code> package, designate the dataset and variables (aesthetics) to be included. This creates a plot space with nothing in it - we will add data in the next steps below.</li>
</ol>
<div class="cell">
<div class="sourceCode" id="cb15"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co">#load ggplot2</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co"># create the plot space</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mydata_corrected,</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> WeightPRE,</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> WeightPOST))</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure>
<p><img src="module133_DataVis_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="576" /></p>
</figure>
</div>
</div>
</div>
<div style="page-break-after: always;"></div>
<ol start="2" type="1">
<li>Next add <code>+</code> a “geometric object” or “geom” to show the data as points.</li>
</ol>
<div class="cell">
<div class="sourceCode" id="cb16"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mydata_corrected,</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> WeightPRE,</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> WeightPOST)) <span class="sc">+</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure>
<p><img src="module133_DataVis_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="576" /></p>
</figure>
</div>
</div>
</div>
<div style="page-break-after: always;"></div>
<ol start="3" type="1">
<li>We can add color by <code>GenderCoded.f</code></li>
</ol>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class='callout-icon'></i>
</div>
<div class="callout-title-container flex-fill">
Automatic Legend
</div>
</div>
<div class="callout-body-container callout-body">
<p>Notice that by adding <code>color = GenderCoded.f</code> inside the <code>aes()</code> aesthetic that a legend for the coloring of the points is automatically added to the plot. This can be disabled if you wish. Learn more about colors and legends in the <a href="https://ggplot2-book.org/scales-colour"><code>ggplot2</code> book - Chapter 11</a>.</p>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb17"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mydata_corrected,</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> WeightPRE,</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> WeightPOST,</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> GenderCoded.f)) <span class="sc">+</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure>
<p><img src="module133_DataVis_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="576" /></p>
</figure>
</div>
</div>
</div>
<div style="page-break-after: always;"></div>
<ol start="4" type="1">
<li>We can also add labels, a title and better legend title</li>
</ol>
<div class="cell">
<div class="sourceCode" id="cb18"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mydata_corrected,</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> WeightPRE,</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> WeightPOST,</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> GenderCoded.f)) <span class="sc">+</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Weight (in pounds) before program&quot;</span>) <span class="sc">+</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Weight (in pounds) after program&quot;</span>) <span class="sc">+</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Weights (in pounds) before and after&quot;</span>,</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Hypothetical Madeup mydata Dataset&quot;</span>,</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;Gender&quot;</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>  ) </span></code></pre></div>
<div class="cell-output-display">
<div>
<figure>
<p><img src="module133_DataVis_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="576" /></p>
</figure>
</div>
</div>
</div>
<p>Notice that there are 4 weights that seem off. Also notice that the values are within a reasonable range when considering PRE or POST separately, but when you put them together in a scatterplot you can see that the values are off since we expect PRE and POST weights to be somewhat similar.</p>
<ul>
<li>Two individuals have PRE weights that are &lt; 100 pounds (bottom left side of plot).
<ul>
<li>There is a good chance that these weights may have been accidentally recorded as kg (kilograms) instead of in pounds.</li>
</ul></li>
<li>And there are 2 individuals with POST weights around 100-120 lbs, but for whom their PRE weights were 225-260 lbs.
<ul>
<li>There is a good chance that these two data points may have had a typo in the first number (e.g. a weight of 110 should be 210).</li>
</ul></li>
<li>For this made-up dataset, it also appears that all 4 of these odd data points are Males. It is a good idea to explore other “correlates” that may help identify underlying data collection issues.</li>
</ul>
<p>Let’s correct these values.</p>
<div class="cell">
<div class="sourceCode" id="cb19"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># for WeightPRE &lt; 100, convert kg to lbs</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>mydata_corrected <span class="ot">&lt;-</span> mydata_corrected <span class="sc">%&gt;%</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">WeightPRE_corrected =</span> <span class="fu">case_when</span>(</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>    (WeightPRE <span class="sc">&lt;</span> <span class="dv">100</span>) <span class="sc">~</span> WeightPRE <span class="sc">*</span> <span class="fl">2.20462</span>,</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">.default =</span> WeightPRE</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  ))</span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb20"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># For WeightPOST, for</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="co"># SubjectID 28, change WeightPOST=98 to 198</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="co"># since this person&#39;s WeightPRE was 230.</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="co"># also fix SubjectID = 32, for</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="co"># WeightPOST from 109 to 209 since</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="co"># their WeightPRE was 260</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>mydata_corrected <span class="ot">&lt;-</span> mydata_corrected <span class="sc">%&gt;%</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">WeightPOST_corrected =</span> <span class="fu">case_when</span>(</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>    (SubjectID <span class="sc">==</span> <span class="dv">28</span>) <span class="sc">~</span> <span class="dv">198</span>,</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>    (SubjectID <span class="sc">==</span> <span class="dv">32</span>) <span class="sc">~</span> <span class="dv">209</span>,</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">.default =</span> WeightPOST</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>  ))</span></code></pre></div>
</div>
<div style="page-break-after: always;"></div>
<p>Let’s redo the plot with these corrected values - now the PRE and POST weights look similar.</p>
<p>I’ve also added a “reference line” (in “red” color) to the plot below. By adding the line “Y = X” we can also visualize which points are above or below the line for people who gained or lost weight from PRE-to-POST, respectively. It looks like most people lost weight - the majority of the points are below the line where PRE &gt; POST weights.</p>
<p>I also:</p>
<ul>
<li>applied colors to each gender category,</li>
<li>applied shapes to each gender category,</li>
<li>changed the size of the points,</li>
<li>assigned custom colors for each gender category,
<ul>
<li>the colors are for the non-missing values</li>
<li>if you want to see the person missing a gender, we have to specifically assign a color for NA using <code>na.value=</code></li>
</ul></li>
<li>assigned custom shapes for each gender category,
<ul>
<li>the colors are for the non-missing values</li>
<li>if you want to see the person missing a gender, we have to specifically assign a color for NA using <code>na.value=</code></li>
</ul></li>
<li>also notice that I had to provide a custom label in the <code>labs()</code> for the shape and color legend - <strong>the labels are the same for <code>color</code> and <code>shape</code></strong> so they will be in the same legend box. <em>It is possible to assign the variables for color and shape to different variables.</em></li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb21"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mydata_corrected,</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> WeightPRE_corrected,</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> WeightPOST_corrected,</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> GenderCoded.f,</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">shape =</span> GenderCoded.f)) <span class="sc">+</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, </span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">intercept =</span> <span class="dv">0</span>,</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">16</span>, <span class="dv">17</span>),</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>                     <span class="at">na.value =</span> <span class="dv">15</span>) <span class="sc">+</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>, </span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;magenta&quot;</span>),</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>                     <span class="at">na.value =</span> <span class="st">&quot;grey30&quot;</span>) <span class="sc">+</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Weight (in pounds) before program&quot;</span>) <span class="sc">+</span></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Weight (in pounds) after program&quot;</span>) <span class="sc">+</span></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Weights (in pounds) before and after&quot;</span>,</span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Hypothetical Madeup mydata Dataset&quot;</span>,</span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;Gender&quot;</span>,</span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">shape =</span> <span class="st">&quot;Gender&quot;</span></span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>  ) </span></code></pre></div>
<div class="cell-output-display">
<div>
<figure>
<p><img src="module133_DataVis_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="576" /></p>
</figure>
</div>
</div>
</div>
<div style="page-break-after: always;"></div>
</section>
<section id="ggplot2---histogram" class="level3">
<h3><code>ggplot2</code> - Histogram</h3>
<p>Let’s make a histogram of <code>Age</code> and overlay a density curve like we did above for the heights, but this time using the <code>ggplot2</code> package functions.</p>
<p>The first step:</p>
<ul>
<li>specify the dataset <code>mydata_corrected</code> and “aesthetics” variable <code>x=Age</code> inside the <code>ggplot()</code> step</li>
<li>then add the geometric object <code>geom_histogram()</code></li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb22"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mydata_corrected, </span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Age)) <span class="sc">+</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>()</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure>
<p><img src="module133_DataVis_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="576" /></p>
</figure>
</div>
</div>
</div>
<div style="page-break-after: always;"></div>
<p>Let’s add some color using <code>fill=</code> for the inside colors of the bars and <code>color=</code> for the border color for the bars.</p>
<div class="cell">
<div class="sourceCode" id="cb23"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mydata_corrected, </span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Age)) <span class="sc">+</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>,</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">&quot;black&quot;</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure>
<p><img src="module133_DataVis_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="576" /></p>
</figure>
</div>
</div>
</div>
<div style="page-break-after: always;"></div>
<p>To add the density curve, we need to do 2 things:</p>
<ol type="1">
<li>Add an aesthetic <code>aes()</code> to change from counts (or frequencies) for the bars to probabilities. We can do this using the <code>after_stat()</code> function.
<ul>
<li>Learn more by running <code>help(aes_eval, package = "ggplot2")</code>.</li>
</ul></li>
<li>And then we can add the <code>geom_density()</code> geometric object and add <code>color=</code> for the overlaid line color.</li>
</ol>
<p>And I also added some better labels to the axes, title and subtitle.</p>
<div class="cell">
<div class="sourceCode" id="cb24"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mydata_corrected, </span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Age,</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> <span class="fu">after_stat</span>(density))) <span class="sc">+</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>,</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Age (in years)&quot;</span>) <span class="sc">+</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Proportion&quot;</span>) <span class="sc">+</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Ages for Participants&quot;</span>,</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Hypothetical Madeup mydata Dataset&quot;</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>  ) </span></code></pre></div>
<div class="cell-output-display">
<div>
<figure>
<p><img src="module133_DataVis_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="576" /></p>
</figure>
</div>
</div>
</div>
<div style="page-break-after: always;"></div>
</section>
<section id="ggplot2---boxplot-and-variations" class="level3">
<h3><code>ggplot2</code> - Boxplot (and variations)</h3>
<p>Let’s look at the corrected PRE weights by SES.</p>
<div class="cell">
<div class="sourceCode" id="cb25"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mydata_corrected,</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> SES.f,</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> WeightPRE_corrected)) <span class="sc">+</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure>
<p><img src="module133_DataVis_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid" width="576" /></p>
</figure>
</div>
</div>
</div>
<div style="page-break-after: always;"></div>
<p>There is one person missing SES. So, let’s filter the dataset and remake the plot. Instead of creating another “new” dataset, we can use the <code>dplyr</code> pipe <code>%&gt;%</code> into our plotting workflow as follows to filter out the missing SES before we make the plot. Notice I can drop the <code>data =</code> in the <code>ggplot()</code> step.</p>
<p>In the <code>filter()</code> step below, I used the <code>!</code> exclamation point to indicate that we want to keep all rows for which <code>SES.f</code> is NOT missing, by using <code>!is.na()</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb26"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>mydata_corrected <span class="sc">%&gt;%</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(SES.f)) <span class="sc">%&gt;%</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> SES.f, </span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> WeightPRE_corrected)) <span class="sc">+</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure>
<p><img src="module133_DataVis_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="576" /></p>
</figure>
</div>
</div>
</div>
<div style="page-break-after: always;"></div>
<p>Let’s add a fill color for the SES categories. Notice that a legend is automatically added to the plot for the SES colors.</p>
<div class="cell">
<div class="sourceCode" id="cb27"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>mydata_corrected <span class="sc">%&gt;%</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(SES.f)) <span class="sc">%&gt;%</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> SES.f, </span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> WeightPRE_corrected,</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> SES.f)) <span class="sc">+</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure>
<p><img src="module133_DataVis_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid" width="576" /></p>
</figure>
</div>
</div>
</div>
<div style="page-break-after: always;"></div>
<p>And add better axis labels plus a title and subtitle.</p>
<div class="cell">
<div class="sourceCode" id="cb28"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>mydata_corrected <span class="sc">%&gt;%</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(SES.f)) <span class="sc">%&gt;%</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> SES.f, </span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> WeightPRE_corrected,</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> SES.f)) <span class="sc">+</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Socio-Economic Status Categories&quot;</span>) <span class="sc">+</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Weight (in pounds) before program&quot;</span>) <span class="sc">+</span></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Weights by SES Categories&quot;</span>,</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Hypothetical Madeup mydata Dataset&quot;</span></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>  ) </span></code></pre></div>
<div class="cell-output-display">
<div>
<figure>
<p><img src="module133_DataVis_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid" width="576" /></p>
</figure>
</div>
</div>
</div>
<div style="page-break-after: always;"></div>
<p><strong>Add Another Layer with Points</strong></p>
<p>We can also add points on top of the boxplots using <code>geom_jitter()</code> AFTER using <code>geom_boxplot</code>. If you switch the order of these “geom’s” you can specify whether the boxplot is on top of the points or if the points are on top of the boxplots (like we did here).</p>
<p>In <code>geom_jitter()</code>, I also added <code>height=0</code> and <code>width=.10</code> to adjust the amount of jitter in the vertical and horizontal directions.</p>
<div class="cell">
<div class="sourceCode" id="cb29"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>mydata_corrected <span class="sc">%&gt;%</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(SES.f)) <span class="sc">%&gt;%</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> SES.f, </span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> WeightPRE_corrected,</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> SES.f)) <span class="sc">+</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">height=</span><span class="dv">0</span>, </span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">width=</span>.<span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Socio-Economic Status Categories&quot;</span>) <span class="sc">+</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Weight (in pounds) before program&quot;</span>) <span class="sc">+</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Weights by SES Categories&quot;</span>,</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Hypothetical Madeup mydata Dataset&quot;</span>,</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">&quot;SES Categories&quot;</span></span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>  ) </span></code></pre></div>
<div class="cell-output-display">
<div>
<figure>
<p><img src="module133_DataVis_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid" width="576" /></p>
</figure>
</div>
</div>
</div>
<p>A couple more packages to look at the distribution of data points by groups are:</p>
<ul>
<li><code>beeswarm</code>
<ul>
<li><a href="https://r-graph-gallery.com/beeswarm.html">R Graph Gallery Example of <code>beeswarm</code></a></li>
<li><a href="https://cran.r-project.org/web/packages/beeswarm/index.html"><code>beeswarm</code> on CRAN</a></li>
</ul></li>
<li><a href="https://cran.r-project.org/web/packages/ggbeeswarm/index.html"><code>ggbeeswarm</code> on CRAN</a></li>
</ul>
<div style="page-break-after: always;"></div>
<p><strong>Try Another Geom</strong></p>
<p>One of the cool things about <code>ggplot2</code> is the ability to easily swap out <code>geom</code>’s. Let’s try a violin plot which provides a better idea of the shape of the underlying distributions that you don’t get with a simple boxplot. Change <code>geom_boxplot()</code> to <code>geom_violin()</code>. I also added the <code>bw</code> argument to change the “bandwidth” for how much smoothing is done. Try changing this number and see what happens. Learn more by running <code>help(geom_violin, package = "ggplot2")</code></p>
<div class="cell">
<div class="sourceCode" id="cb30"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>mydata_corrected <span class="sc">%&gt;%</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(SES.f)) <span class="sc">%&gt;%</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> SES.f, </span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> WeightPRE_corrected,</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> SES.f)) <span class="sc">+</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">bw=</span><span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Socio-Economic Status Categories&quot;</span>) <span class="sc">+</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Weight (in pounds) before program&quot;</span>) <span class="sc">+</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Weights by SES Categories&quot;</span>,</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Hypothetical Madeup mydata Dataset&quot;</span></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>  ) </span></code></pre></div>
<div class="cell-output-display">
<div>
<figure>
<p><img src="module133_DataVis_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid" width="576" /></p>
</figure>
</div>
</div>
</div>
<div style="page-break-after: always;"></div>
</section>
<section id="ggplot2---barchart" class="level3">
<h3><code>ggplot2</code> - Barchart</h3>
<p>Let’s make a simple barchart for <code>SES.f</code> after filtering out the <code>NA</code>s.</p>
<div class="cell">
<div class="sourceCode" id="cb31"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>mydata_corrected <span class="sc">%&gt;%</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(SES.f)) <span class="sc">%&gt;%</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> SES.f)) <span class="sc">+</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>()</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure>
<p><img src="module133_DataVis_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid" width="576" /></p>
</figure>
</div>
</div>
</div>
<div style="page-break-after: always;"></div>
<p>Let’s also make a clustered barplot of <code>SES.f</code> by <code>GenderCoded.f</code>. Let’s also filter out the <code>NA</code>s from <code>GenderCoded.f</code> as well.</p>
<p>To add the 2nd grouping or clustering variable, we add <code>fill=</code> to the aesthetics and then add <code>position = "dodge"</code> for <code>geom_bar()</code> to see the colors side by side instead of stacked.</p>
<div class="cell">
<div class="sourceCode" id="cb32"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>mydata_corrected <span class="sc">%&gt;%</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(SES.f)) <span class="sc">%&gt;%</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(GenderCoded.f)) <span class="sc">%&gt;%</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> SES.f,</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> GenderCoded.f)) <span class="sc">+</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">&quot;dodge&quot;</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure>
<p><img src="module133_DataVis_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid" width="576" /></p>
</figure>
</div>
</div>
</div>
<div style="page-break-after: always;"></div>
<p>Let’s also add custom colors and better labels. A few notes:</p>
<ul>
<li><code>fill</code> controls the interior filled color for the bars</li>
<li><code>color</code> controls the border color of the bars</li>
<li><code>scale_fill_manual()</code> is where you add custom colors</li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb33"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>mydata_corrected <span class="sc">%&gt;%</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(SES.f)) <span class="sc">%&gt;%</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(GenderCoded.f)) <span class="sc">%&gt;%</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> SES.f,</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> GenderCoded.f)) <span class="sc">+</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">&quot;dodge&quot;</span>, </span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>, </span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>                               <span class="st">&quot;magenta&quot;</span>)) <span class="sc">+</span></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Socio-Economic Status Categories&quot;</span>) <span class="sc">+</span></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Frequency&quot;</span>) <span class="sc">+</span></span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Frequencies of SES Categories by Gender&quot;</span>,</span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Hypothetical Madeup mydata Dataset&quot;</span>,</span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">&quot;Gender&quot;</span></span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure>
<p><img src="module133_DataVis_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid" width="576" /></p>
</figure>
</div>
</div>
</div>
<div style="page-break-after: always;"></div>
</section>
<section id="ggplot2---errorbar-plots" class="level3">
<h3><code>ggplot2</code> - Errorbar plots</h3>
<p><strong>Barplot with Error Bars</strong></p>
<p>Suppose instead of boxplots for looking at the differences in heights by gender, let’s make a plot of the mean heights by gender with error bars added to reflect the 95% confidence intervals for these group means.</p>
<p>First let’s compute the means using the <code>mean()</code> function and we’ll pull the 95% confidence interval limits from the <code>t.test()</code> output for a one-sample t-test <em>(see details below)</em>.</p>
<p>Save these outputs into another small dataset called <code>dt</code>.</p>
<p><strong>Let’s take a look at the <code>t.test()</code> output.</strong></p>
<p>We can run a one-sample t-test to test whether the mean of the Heights is different from 0. This will result in a p-value for this hypothesis test. The <code>t.test()</code> output can also be used to evaluate to see whether or not the 95% confidence interval contains 0 or not.</p>
<p><span class="math display">\[H_0: \mu_{height} = 0\]</span> versus</p>
<p><span class="math display">\[H_a: \mu_{height} \neq 0\]</span></p>
<div class="cell">
<div class="sourceCode" id="cb34"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># run one-sample t-test and save the output</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="co"># into an object called tt1</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>tt1 <span class="ot">&lt;-</span> <span class="fu">t.test</span>(mydata_corrected<span class="sc">$</span>Height_corrected, </span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">conf.level =</span> <span class="fl">0.95</span>)</span></code></pre></div>
</div>
<p>If we print the <code>tt1</code> object to the console, we get the abbreviated t-test results which gives us the t-test statistic, p-value, the mean of the heights and the 95% confidence interval for that mean (which does not include 0).</p>
<div class="cell">
<div class="sourceCode" id="cb35"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>tt1</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    One Sample t-test

data:  mydata_corrected$Height_corrected
t = 61.664, df = 18, p-value &lt; 2.2e-16
alternative hypothesis: true mean is not equal to 0
95 percent confidence interval:
 5.658315 6.057475
sample estimates:
mean of x 
 5.857895 </code></pre>
</div>
</div>
<p>But the <code>tt1</code> t-test output object actually has a bunch of details stored inside it. Let’s look at the structure of the <code>tt1</code> t-test object:</p>
<div class="cell">
<div class="sourceCode" id="cb37"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(tt1)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>List of 10
 $ statistic  : Named num 61.7
  ..- attr(*, &quot;names&quot;)= chr &quot;t&quot;
 $ parameter  : Named num 18
  ..- attr(*, &quot;names&quot;)= chr &quot;df&quot;
 $ p.value    : num 2.13e-22
 $ conf.int   : num [1:2] 5.66 6.06
  ..- attr(*, &quot;conf.level&quot;)= num 0.95
 $ estimate   : Named num 5.86
  ..- attr(*, &quot;names&quot;)= chr &quot;mean of x&quot;
 $ null.value : Named num 0
  ..- attr(*, &quot;names&quot;)= chr &quot;mean&quot;
 $ stderr     : num 0.095
 $ alternative: chr &quot;two.sided&quot;
 $ method     : chr &quot;One Sample t-test&quot;
 $ data.name  : chr &quot;mydata_corrected$Height_corrected&quot;
 - attr(*, &quot;class&quot;)= chr &quot;htest&quot;</code></pre>
</div>
</div>
<p>We can select elements of this t-test object just like we select variables out of a dataset using the <code>$</code> dollar sign selector. Let’s take a look at the <code>conf.int</code> part of the t-test object for the 95% confidence interval limits.</p>
<div class="cell">
<div class="sourceCode" id="cb39"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>tt1<span class="sc">$</span>conf.int</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5.658315 6.057475
attr(,&quot;conf.level&quot;)
[1] 0.95</code></pre>
</div>
</div>
<p>We can further pull out each limit separately using the <code>[]</code> square brackets to pull specifically the first element <code>[1]</code> for the lower limit of the 95% confidence interval and the second element <code>[2]</code> for the upper limit of the 95% confidence interval.</p>
<div class="cell">
<div class="sourceCode" id="cb41"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>tt1<span class="sc">$</span>conf.int[<span class="dv">1</span>]</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5.658315</code></pre>
</div>
<div class="sourceCode" id="cb43"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>tt1<span class="sc">$</span>conf.int[<span class="dv">2</span>]</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6.057475</code></pre>
</div>
</div>
<p>So, we will save these components from the t-test output inside the <code>mutate</code> step in the code below to make sure we capture the lower confidence interval <code>lci</code> and upper confidence interval <code>uci</code> for each gender category which we will later use for making our error bars.</p>
<div class="cell">
<div class="sourceCode" id="cb45"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># capture the means of the correct heights </span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="co"># and get the 95% confidence intervals</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="co"># upper bound and lower bound by gender</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="co"># filter out the missing GenderCoded.f</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>dt <span class="ot">&lt;-</span> mydata_corrected <span class="sc">%&gt;%</span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(GenderCoded.f)) <span class="sc">%&gt;%</span></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(GenderCoded.f)<span class="sc">%&gt;%</span></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean =</span> <span class="fu">mean</span>(Height_corrected, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">lci =</span> <span class="fu">t.test</span>(Height_corrected, </span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>                 <span class="at">conf.level =</span> <span class="fl">0.95</span>)<span class="sc">$</span>conf.int[<span class="dv">1</span>],</span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">uci =</span> <span class="fu">t.test</span>(Height_corrected, </span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>                 <span class="at">conf.level =</span> <span class="fl">0.95</span>)<span class="sc">$</span>conf.int[<span class="dv">2</span>])</span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>dt</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
  GenderCoded.f  mean   lci   uci
  &lt;fct&gt;         &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 Male           6.1   5.86  6.34
2 Female         5.59  5.30  5.88</code></pre>
</div>
</div>
<div style="page-break-after: always;"></div>
<p>Use this small dataset <code>dt</code> with the means and 95% confidence intervals limits to make this plot.</p>
<div class="cell">
<div class="sourceCode" id="cb47"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> dt) <span class="sc">+</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">x =</span> GenderCoded.f, </span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">y =</span> mean, </span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">fill =</span> GenderCoded.f), </span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">stat=</span><span class="st">&quot;identity&quot;</span>) <span class="sc">+</span></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>, </span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>                               <span class="st">&quot;magenta&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">x =</span> GenderCoded.f, </span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ymin =</span> lci, </span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ymax =</span> uci), </span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.4</span>, </span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>                <span class="at">color =</span><span class="st">&quot;black&quot;</span>, </span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>                <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Gender&quot;</span>) <span class="sc">+</span></span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Mean Height (in decimal feet)&quot;</span>) <span class="sc">+</span></span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Average Heights by Gender&quot;</span>,</span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Hypothetical Madeup mydata Dataset&quot;</span>,</span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">&quot;Error Bars Represent 95% Confidence Intervals&quot;</span>,</span>
<span id="cb47-21"><a href="#cb47-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">&quot;Gender&quot;</span></span>
<span id="cb47-22"><a href="#cb47-22" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure>
<p><img src="module133_DataVis_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid" width="576" /></p>
</figure>
</div>
</div>
</div>
<div style="page-break-after: always;"></div>
<p><strong>Lineplot with Points and Error Bars</strong></p>
<p>We can also remove the bars and just create a line plot connecting the points for the means with the error bars shown. I set <code>size=1.5</code>to make the lines a little thicker in the plot.</p>
<div class="cell">
<div class="sourceCode" id="cb48"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> dt) <span class="sc">+</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> GenderCoded.f, </span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">y =</span> mean,</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> GenderCoded.f),</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">x =</span> GenderCoded.f, </span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ymin =</span> lci, </span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ymax =</span> uci,</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">color =</span> GenderCoded.f), </span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.4</span>, </span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>                <span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> GenderCoded.f, </span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> mean), </span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">group =</span> <span class="dv">1</span>,</span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="fl">1.5</span>,</span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>, </span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a>                               <span class="st">&quot;magenta&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Gender&quot;</span>) <span class="sc">+</span></span>
<span id="cb48-20"><a href="#cb48-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Mean Height (in decimal feet)&quot;</span>) <span class="sc">+</span></span>
<span id="cb48-21"><a href="#cb48-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb48-22"><a href="#cb48-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Average Heights by Gender&quot;</span>,</span>
<span id="cb48-23"><a href="#cb48-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Hypothetical Madeup mydata Dataset&quot;</span>,</span>
<span id="cb48-24"><a href="#cb48-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">&quot;Error Bars Represent 95% Confidence Intervals&quot;</span>,</span>
<span id="cb48-25"><a href="#cb48-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;Gender&quot;</span></span>
<span id="cb48-26"><a href="#cb48-26" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure>
<p><img src="module133_DataVis_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid" width="576" /></p>
</figure>
</div>
</div>
</div>
<div style="page-break-after: always;"></div>
</section>
<section id="ggplot2---lollipop-plots" class="level3">
<h3><code>ggplot2</code> - Lollipop plots</h3>
<p>Another plot that can be useful to help visualize changes between two time points,like PRE-to-POST changes is using a “lollipop” plot which utilizes the <code>geom_segment()</code> to create line segments with points (the lollipops) on each end.</p>
<p>The plot below was inspired by the code example at <a href="https://r-graph-gallery.com/303-lollipop-plot-with-2-values.html">https://r-graph-gallery.com/303-lollipop-plot-with-2-values.html</a>.</p>
<p>Let’s look at the corrected Weights PRE to POST- sorted by their starting PRE weights.</p>
<div class="cell">
<div class="sourceCode" id="cb49"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># sort data by WeightPRE_corrected ascending</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> mydata_corrected <span class="sc">%&gt;%</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(WeightPRE_corrected) <span class="sc">%&gt;%</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SubjectID =</span> <span class="fu">factor</span>(SubjectID, SubjectID))</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data) <span class="sc">+</span></span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> SubjectID,</span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>                   <span class="at">xend =</span> SubjectID,</span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> WeightPRE_corrected,</span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>                   <span class="at">yend =</span> WeightPOST_corrected), </span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;grey30&quot;</span>) <span class="sc">+</span></span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> SubjectID, </span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a>                 <span class="at">y =</span> WeightPRE_corrected,</span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">&quot;WeightPRE_corrected&quot;</span>),</span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> SubjectID, </span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a>                 <span class="at">y =</span> WeightPOST_corrected,</span>
<span id="cb49-20"><a href="#cb49-20" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">&quot;WeightPOST_corrected&quot;</span>),</span>
<span id="cb49-21"><a href="#cb49-21" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb49-22"><a href="#cb49-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(</span>
<span id="cb49-23"><a href="#cb49-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;PRE&quot;</span>, <span class="st">&quot;POST&quot;</span>),</span>
<span id="cb49-24"><a href="#cb49-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;coral&quot;</span>,<span class="st">&quot;darkblue&quot;</span>),</span>
<span id="cb49-25"><a href="#cb49-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">guide  =</span> <span class="fu">guide_legend</span>(), </span>
<span id="cb49-26"><a href="#cb49-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">name   =</span> <span class="st">&quot;Group&quot;</span>) <span class="sc">+</span></span>
<span id="cb49-27"><a href="#cb49-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb49-28"><a href="#cb49-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>) <span class="sc">+</span></span>
<span id="cb49-29"><a href="#cb49-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Subject IDs&quot;</span>) <span class="sc">+</span></span>
<span id="cb49-30"><a href="#cb49-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Weight Change (in pounds) PRE to POST&quot;</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure>
<p><img src="module133_DataVis_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid" width="576" /></p>
</figure>
</div>
</div>
</div>
<hr />
<div style="page-break-after: always;"></div>
</section>
</section>
<section id="other-graphics-packages-to-know" class="level2">
<h2>3. Other Graphics Packages to Know</h2>
<section id="save-plot-objects-and-reuserearrange-them" class="level3">
<h3>Save plot objects and reuse/rearrange them</h3>
<p>Once a “chunk” of <code>ggplot</code> code is run, technically a <code>ggplot2</code> plot object is created. We can save and reuse these objects to create composite figures.</p>
<p>For example, let’s create the scatterplot, histogram and clustered barplot and save each into three separate plot objects <code>p1</code>, <code>p2</code>, and <code>p3</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb50"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># make the scatterplot, save as p1</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata_corrected,</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> WeightPRE_corrected,</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> WeightPOST_corrected,</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> GenderCoded.f,</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">shape =</span> GenderCoded.f</span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">+</span></span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>,</span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>              <span class="at">intercept =</span> <span class="dv">0</span>,</span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">16</span>, <span class="dv">17</span>), <span class="at">na.value =</span> <span class="dv">15</span>) <span class="sc">+</span></span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;magenta&quot;</span>),</span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a>                     <span class="at">na.value =</span> <span class="st">&quot;grey30&quot;</span>) <span class="sc">+</span></span>
<span id="cb50-18"><a href="#cb50-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Weight (in pounds) before program&quot;</span>) <span class="sc">+</span></span>
<span id="cb50-19"><a href="#cb50-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Weight (in pounds) after program&quot;</span>) <span class="sc">+</span></span>
<span id="cb50-20"><a href="#cb50-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb50-21"><a href="#cb50-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Weights (in pounds) before and after&quot;</span>,</span>
<span id="cb50-22"><a href="#cb50-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Hypothetical Madeup mydata Dataset&quot;</span>,</span>
<span id="cb50-23"><a href="#cb50-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;Gender&quot;</span>,</span>
<span id="cb50-24"><a href="#cb50-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">shape =</span> <span class="st">&quot;Gender&quot;</span></span>
<span id="cb50-25"><a href="#cb50-25" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb51"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># make the histogram, save as p2</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mydata_corrected, </span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> Age, </span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">y =</span> <span class="fu">after_stat</span>(density))) <span class="sc">+</span></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Age (in years)&quot;</span>) <span class="sc">+</span></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Proportion&quot;</span>) <span class="sc">+</span></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Ages for Participants&quot;</span>, </span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Hypothetical Madeup mydata Dataset&quot;</span>)</span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb52"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># make the barplot, save as p3</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> mydata_corrected <span class="sc">%&gt;%</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(SES.f)) <span class="sc">%&gt;%</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(GenderCoded.f)) <span class="sc">%&gt;%</span></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> SES.f,</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> GenderCoded.f)) <span class="sc">+</span></span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">&quot;dodge&quot;</span>, </span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>, </span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>                               <span class="st">&quot;magenta&quot;</span>)) <span class="sc">+</span></span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Socio-Economic Status Categories&quot;</span>) <span class="sc">+</span></span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Frequency&quot;</span>) <span class="sc">+</span></span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Frequencies of SES Categories by Gender&quot;</span>,</span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Hypothetical Madeup mydata Dataset&quot;</span>,</span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">&quot;Gender&quot;</span></span>
<span id="cb52-18"><a href="#cb52-18" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
</div>
<div style="page-break-after: always;"></div>
<section id="patchwork-package" class="level4">
<h4><strong><code>patchwork</code> package</strong></h4>
<p>After making and saving each of the <code>ggplot2</code> plot objects above, we can arrange them into a new composite plot. The <a href="https://cran.r-project.org/web/packages/patchwork/index.html"><code>patchwork</code> package</a> is really good for making these composite figures.</p>
<p>Learn more at <a href="https://patchwork.data-imaginist.com/articles/patchwork.html">https://patchwork.data-imaginist.com/articles/patchwork.html</a></p>
<div class="cell">
<div class="sourceCode" id="cb53"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load patchwork package</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a><span class="co"># put p1 and p2 side-by-side</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a><span class="co"># and put both of these on top of p3</span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>(p1 <span class="sc">+</span> p2) <span class="sc">/</span> p3</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure>
<p><img src="module133_DataVis_files/figure-html/unnamed-chunk-44-1.png" class="img-fluid" width="576" /></p>
</figure>
</div>
</div>
</div>
<div style="page-break-after: always;"></div>
</section>
<section id="ggpubr-package-and-ggarrange-function" class="level4">
<h4><strong><code>ggpubr</code> package and <code>ggarrange()</code> function</strong></h4>
<p>Another package that is useful for arrange plot objects into composite plots is the <a href="https://cran.r-project.org/web/packages/ggpubr/"><code>ggpubr</code> package</a> with the <a href="https://rpkgs.datanovia.com/ggpubr/reference/ggarrange.html"><code>ggarrange()</code> function</a>.</p>
<div class="cell">
<div class="sourceCode" id="cb54"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load ggpubr package</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="co"># use ggarrange twice</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a><span class="co"># put p1 and p2 side by side</span></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a><span class="co"># then put on top of p3</span></span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggarrange</span>(p1, p2, <span class="at">widths =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>)),</span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>  p3, <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">ncol =</span> <span class="dv">1</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure>
<p><img src="module133_DataVis_files/figure-html/unnamed-chunk-45-1.png" class="img-fluid" width="576" /></p>
</figure>
</div>
</div>
</div>
<div style="page-break-after: always;"></div>
</section>
</section>
<section id="ggally-package-and-ggpairs-function" class="level3">
<h3><code>GGally</code> package and <code>ggpairs()</code> function</h3>
<p>If you would like to make a scatterplot matrix to look at the associations (correlations) between multiple numeric variables at the same time, the <a href="https://ggobi.github.io/ggally/articles/ggpairs.html"><code>GGally::ggpairs()</code> function</a> is useful.</p>
<p>In the plot below, we can see the 2-dimensional scatterplots between the heights and weights at PRE and POST. The plot also provides the Pearson’s correlations for all of the pairwise associations between each combination of 2 variables.</p>
<p>I also added a “best fit” linear line by adding <code>lower = list(continuous = "smooth")</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb55"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GGally)</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggpairs</span>(mydata_corrected,</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">&quot;Height_corrected&quot;</span>, </span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&quot;WeightPRE_corrected&quot;</span>, </span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&quot;WeightPOST_corrected&quot;</span>),</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">lower =</span> <span class="fu">list</span>(<span class="at">continuous =</span> <span class="st">&quot;smooth&quot;</span>))</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure>
<p><img src="module133_DataVis_files/figure-html/unnamed-chunk-46-1.png" class="img-fluid" width="576" /></p>
</figure>
</div>
</div>
</div>
<div style="page-break-after: always;"></div>
<p>What is really cool about this plotting function is the easy way to add in a 3rd variable like gender to see if these correlations (and scatterplots) change by gender (i.e. does gender moderate the associations?). Notice that we get separate lines for each gender and we get the correlations for each gender as well.</p>
<p>If you look at the correlations by gender between <code>Height_corrected</code> and <code>WeightPOST_corrected</code> the correlation for Males was 0.692 and for Females was 0.913, so it does look like the correlation is stronger for the Females than the Males. For this made-up dataset, this doesn’t matter. But this approach is a good way to start exploring your data for moderating effects.</p>
<div class="cell">
<div class="sourceCode" id="cb56"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggpairs</span>(mydata_corrected,</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">color =</span> GenderCoded.f),</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">&quot;Height_corrected&quot;</span>, </span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&quot;WeightPRE_corrected&quot;</span>, </span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&quot;WeightPOST_corrected&quot;</span>),</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">lower =</span> <span class="fu">list</span>(<span class="at">continuous =</span> <span class="st">&quot;smooth&quot;</span>))</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure>
<p><img src="module133_DataVis_files/figure-html/unnamed-chunk-47-1.png" class="img-fluid" width="576" /></p>
</figure>
</div>
</div>
</div>
<div style="page-break-after: always;"></div>
<p>And if we add <code>GenderCoded.f</code> to the list of variable columns to be included, we now also get bar charts for the frequencies of each gender, histograms of each variable for each gender, boxplots for each variable by each gender, along with the density curves by gender and the correlation matrix.</p>
<div class="cell">
<div class="sourceCode" id="cb57"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggpairs</span>(mydata_corrected,</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">color =</span> GenderCoded.f),</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">&quot;GenderCoded.f&quot;</span>,</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&quot;Height_corrected&quot;</span>, </span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&quot;WeightPRE_corrected&quot;</span>, </span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&quot;WeightPOST_corrected&quot;</span>),</span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">lower =</span> <span class="fu">list</span>(<span class="at">continuous =</span> <span class="st">&quot;smooth&quot;</span>))</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure>
<p><img src="module133_DataVis_files/figure-html/unnamed-chunk-48-1.png" class="img-fluid" width="576" /></p>
</figure>
</div>
</div>
</div>
<div style="page-break-after: always;"></div>
</section>
<section id="visualize-categorical-data-with-vcd-package" class="level3">
<h3>Visualize Categorical Data with <code>vcd</code> package</h3>
<p>The <a href="https://cran.r-project.org/web/packages/vcd/index.html"><code>vcd</code> package</a> for “visualizing categorical data” has been around for over 20 years!! It is a helpful package for visualizing multiple categorical variables at once.</p>
<p>Let’s visualize the relative proportions of gender and SES using the <code>vcd::mosaic()</code> function.</p>
<div class="cell">
<div class="sourceCode" id="cb58"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vcd)</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>vcd<span class="sc">::</span><span class="fu">mosaic</span>(GenderCoded.f <span class="sc">~</span> SES.f, </span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> mydata_corrected,</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">gp =</span> <span class="fu">gpar</span>(<span class="at">fill =</span> <span class="fu">c</span>(<span class="st">&quot;gray&quot;</span>,<span class="st">&quot;dark magenta&quot;</span>)),</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">main =</span> <span class="st">&quot;Gender and SES&quot;</span>,</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>            )</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure>
<p><img src="module133_DataVis_files/figure-html/unnamed-chunk-49-1.png" class="img-fluid" width="576" /></p>
</figure>
</div>
</div>
</div>
<div style="page-break-after: always;"></div>
</section>
<section id="example-of-an-animated-graph-with-gganimate" class="level3">
<h3>Example of an animated graph with <code>gganimate</code></h3>
<p>Learn how to make an animated figure with the <code>gganimate</code> package at <a href="https://gganimate.com/">https://gganimate.com/</a>. The animation demo shown below is of the relationship between Life Expectancy and GDP (gross domestic product) per capita in 142 countries over 12 years from 1952 to 2007.</p>
<p>The animated figure is viewable in the HTML website at <a href="https://melindahiggins2000.github.io/emory_tidal_Rlectures/module133_DataVis.html">https://melindahiggins2000.github.io/emory_tidal_Rlectures/module133_DataVis.html</a>. In the PDF file only a static view is shown for the single year “1976” from the <a href="https://jennybc.github.io/gapminder/"><code>gapminder</code></a> dataset and R package.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img src="myannimategif.gif" class="img-fluid" style="width:95.0%" /></p>
</figure>
</div>
</div>
</div>
<div style="page-break-after: always;"></div>
</section>
<section id="interactive-graphics-with-plotly" class="level3">
<h3>Interactive Graphics with <code>plotly</code></h3>
<p>Another cool package is the <code>plotly</code> graphics package which allows for active interaction with the plot. This works in the RStudio environment (viewing in the “Viewer” window) and from within an HTML formatted document rendered from Rmarkdown.</p>
<p>Learn more at <a href="https://plotly-r.com/">https://plotly-r.com/</a>.</p>
<p>Here is an interactive version (on this website for the HTML version) of the side-by-side boxplots below - with a horizontal orientation. <em>This plot will NOT be interactive in the PDF document but the figure will be shown.</em></p>
<div class="cell">
<div class="sourceCode" id="cb59"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>fig <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(mydata_corrected, </span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">x =</span> <span class="sc">~</span>WeightPRE_corrected, </span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="sc">~</span>SES.f, </span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">type =</span> <span class="st">&quot;box&quot;</span>,</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">orientation =</span> <span class="st">&quot;h&quot;</span>)</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>fig</span></code></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-95ba538b3f68b945e0ca" style="width:100%;height:650px;"></div>
<script type="application/json" data-for="htmlwidget-95ba538b3f68b945e0ca">{"x":{"visdat":{"550415e12f46":["function () ","plotlyVisDat"]},"cur_data":"550415e12f46","attrs":{"550415e12f46":{"x":{},"orientation":"h","color":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"box"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1],"automargin":true,"title":"WeightPRE_corrected"},"yaxis":{"domain":[0,1],"automargin":true},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"fillcolor":"rgba(102,194,165,0.5)","x":[190,230,200,190],"orientation":"h","type":"box","name":"low income","marker":{"color":"rgba(102,194,165,1)","line":{"color":"rgba(102,194,165,1)"}},"line":{"color":"rgba(102,194,165,1)"},"xaxis":"x","yaxis":"y","frame":null},{"fillcolor":"rgba(252,141,98,0.5)","x":[167,143,216,243,165,132.27719999999999,167,240,250,175,220,230],"orientation":"h","type":"box","name":"average income","marker":{"color":"rgba(252,141,98,1)","line":{"color":"rgba(252,141,98,1)"}},"line":{"color":"rgba(252,141,98,1)"},"xaxis":"x","yaxis":"y","frame":null},{"fillcolor":"rgba(141,160,203,0.5)","x":[110,180,260],"orientation":"h","type":"box","name":"high income","marker":{"color":"rgba(141,160,203,1)","line":{"color":"rgba(141,160,203,1)"}},"line":{"color":"rgba(141,160,203,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
</section>
<section id="summary-tables-with-graphics" class="level2">
<h2>4. Summary Tables with Graphics</h2>
<p>There are a number of other packages that allow you to insert small graphs or figures inside of a table.</p>
<p>The <a href="https://r-graph-gallery.com/table.html">R Graph Gallery</a> has a nice summary of table packages with these features. Some of these packages include:</p>
<ul>
<li><a href="https://cran.r-project.org/web/packages/gtExtras/index.html"><code>gtExtras</code></a></li>
<li><a href="https://cran.r-project.org/web/packages/huxtable/index.html"><code>huxtable</code></a></li>
<li><a href="https://ardata-fr.github.io/flextable-book/index.html#help-and-resources"><code>flextable</code></a></li>
<li><a href="https://cran.r-project.org/web/packages/skimr/index.html"><code>skimr</code></a></li>
<li><a href="https://modelsummary.com/vignettes/datasummary.html"><code>modelsummary</code></a></li>
<li><a href="https://cran.r-project.org/web/packages/rhandsontable/index.html"><code>rhandsontable</code></a></li>
</ul>
<p>As an example, let’s look at the code at <a href="https://r-graph-gallery.com/368-plotting-in-cells-with-gtextras.html">https://r-graph-gallery.com/368-plotting-in-cells-with-gtextras.html</a> for making a table of summary statistics with a plot overview including a list of categories and percentage of missing data for that variable.</p>
<div class="cell">
<div class="sourceCode" id="cb60"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gtExtras)</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>mydata_corrected <span class="sc">%&gt;%</span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Height_corrected,</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>         WeightPRE_corrected,</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>         WeightPOST_corrected,</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>         GenderCoded.f,</span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>         SES.f) <span class="sc">%&gt;%</span></span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt_plt_summary</span>()</span></code></pre></div>
<div class="cell-output-display">
<div id="vtlizfakmp" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>@import url("https://fonts.googleapis.com/css2?family=Lato:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
#vtlizfakmp table {
  font-family: Lato, system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#vtlizfakmp thead, #vtlizfakmp tbody, #vtlizfakmp tfoot, #vtlizfakmp tr, #vtlizfakmp td, #vtlizfakmp th {
  border-style: none;
}

#vtlizfakmp p {
  margin: 0;
  padding: 0;
}

#vtlizfakmp .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 3px;
  border-top-color: #FFFFFF;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#vtlizfakmp .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#vtlizfakmp .gt_title {
  color: #333333;
  font-size: 24px;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#vtlizfakmp .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#vtlizfakmp .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#vtlizfakmp .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 0px;
  border-bottom-color: #D3D3D3;
}

#vtlizfakmp .gt_col_headings {
  border-top-style: solid;
  border-top-width: 0px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#vtlizfakmp .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#vtlizfakmp .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#vtlizfakmp .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#vtlizfakmp .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#vtlizfakmp .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#vtlizfakmp .gt_spanner_row {
  border-bottom-style: hidden;
}

#vtlizfakmp .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#vtlizfakmp .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#vtlizfakmp .gt_from_md > :first-child {
  margin-top: 0;
}

#vtlizfakmp .gt_from_md > :last-child {
  margin-bottom: 0;
}

#vtlizfakmp .gt_row {
  padding-top: 7px;
  padding-bottom: 7px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #F6F7F7;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#vtlizfakmp .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#vtlizfakmp .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#vtlizfakmp .gt_row_group_first td {
  border-top-width: 2px;
}

#vtlizfakmp .gt_row_group_first th {
  border-top-width: 2px;
}

#vtlizfakmp .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#vtlizfakmp .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#vtlizfakmp .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#vtlizfakmp .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vtlizfakmp .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#vtlizfakmp .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#vtlizfakmp .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#vtlizfakmp .gt_striped {
  background-color: #FAFAFA;
}

#vtlizfakmp .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vtlizfakmp .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#vtlizfakmp .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#vtlizfakmp .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#vtlizfakmp .gt_sourcenote {
  font-size: 12px;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#vtlizfakmp .gt_left {
  text-align: left;
}

#vtlizfakmp .gt_center {
  text-align: center;
}

#vtlizfakmp .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#vtlizfakmp .gt_font_normal {
  font-weight: normal;
}

#vtlizfakmp .gt_font_bold {
  font-weight: bold;
}

#vtlizfakmp .gt_font_italic {
  font-style: italic;
}

#vtlizfakmp .gt_super {
  font-size: 65%;
}

#vtlizfakmp .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#vtlizfakmp .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#vtlizfakmp .gt_indent_1 {
  text-indent: 5px;
}

#vtlizfakmp .gt_indent_2 {
  text-indent: 10px;
}

#vtlizfakmp .gt_indent_3 {
  text-indent: 15px;
}

#vtlizfakmp .gt_indent_4 {
  text-indent: 20px;
}

#vtlizfakmp .gt_indent_5 {
  text-indent: 25px;
}

#vtlizfakmp .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#vtlizfakmp div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top" style="width:100%;" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 14%" />
<col style="width: 14%" />
<col style="width: 14%" />
<col style="width: 14%" />
<col style="width: 14%" />
<col style="width: 14%" />
<col style="width: 14%" />
</colgroup>
<thead>
<tr class="gt_heading header">
<th colspan="7" class="gt_heading gt_title gt_font_normal">.</th>
</tr>
<tr class="gt_heading even">
<th colspan="7" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border">21 rows x 5 cols</th>
</tr>
<tr class="gt_col_headings header">
<th id="type" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"></th>
<th id="name" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Column</th>
<th id="value" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Plot Overview</th>
<th id="n_missing" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Missing</th>
<th id="Mean" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Mean</th>
<th id="Median" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Median</th>
<th id="SD" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">SD</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="type"><svg aria-hidden="true" role="img" viewbox="0 0 640 512" style="height:20px;width:25px;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:#f18e2c;overflow:visible;position:relative;">
<path d="M576 0c17.7 0 32 14.3 32 32V480c0 17.7-14.3 32-32 32s-32-14.3-32-32V32c0-17.7 14.3-32 32-32zM448 96c17.7 0 32 14.3 32 32V480c0 17.7-14.3 32-32 32s-32-14.3-32-32V128c0-17.7 14.3-32 32-32zM352 224V480c0 17.7-14.3 32-32 32s-32-14.3-32-32V224c0-17.7 14.3-32 32-32s32 14.3 32 32zM192 288c17.7 0 32 14.3 32 32V480c0 17.7-14.3 32-32 32s-32-14.3-32-32V320c0-17.7 14.3-32 32-32zM96 416v64c0 17.7-14.3 32-32 32s-32-14.3-32-32V416c0-17.7 14.3-32 32-32s32 14.3 32 32z"></path>
</svg></td>
<td class="gt_row gt_left" headers="name" style="font-weight: bold">Height_corrected</td>
<td class="gt_row gt_center" headers="value"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" class="svglite" width="141.73pt" height="34.02pt" viewbox="0 0 141.73 34.02">
<defs>
<style type="text/css">    .svglite line, .svglite polyline, .svglite polygon, .svglite path, .svglite rect, .svglite circle {      fill: none;      stroke: #000000;      stroke-linecap: round;      stroke-linejoin: round;      stroke-miterlimit: 10.00;    }    .svglite text {      white-space: pre;    }  </style>
</defs><rect width="100%" height="100%" style="stroke: none; fill: none;"></rect><defs> <clippath id="cpMC4wMHwxNDEuNzN8MC4wMHwzNC4wMg=="> <rect x="0.00" y="0.00" width="141.73" height="34.02"></rect> </clippath></defs><g clip-path="url(#cpMC4wMHwxNDEuNzN8MC4wMHwzNC4wMg==)"></g><defs> <clippath id="cpMS4wMHwxNDAuNzR8MS4wMHwyMy42Mw=="> <rect x="1.00" y="1.00" width="139.74" height="22.64"></rect> </clippath></defs><g clip-path="url(#cpMS4wMHwxNDAuNzR8MS4wMHwyMy42Mw==)"><rect x="7.35" y="20.40" width="31.76" height="3.23" style="stroke-width: 1.07; stroke: #FFFFFF; stroke-linecap: butt; stroke-linejoin: miter; fill: #F8BB87;"></rect><rect x="39.11" y="4.23" width="31.76" height="19.40" style="stroke-width: 1.07; stroke: #FFFFFF; stroke-linecap: butt; stroke-linejoin: miter; fill: #F8BB87;"></rect><rect x="70.87" y="7.46" width="31.76" height="16.17" style="stroke-width: 1.07; stroke: #FFFFFF; stroke-linecap: butt; stroke-linejoin: miter; fill: #F8BB87;"></rect><rect x="102.63" y="1.00" width="31.76" height="22.64" style="stroke-width: 1.07; stroke: #FFFFFF; stroke-linecap: butt; stroke-linejoin: miter; fill: #F8BB87;"></rect><circle cx="33.06" cy="20.40" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="33.06" cy="20.40" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="33.06" cy="20.40" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="33.06" cy="20.40" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="33.06" cy="20.40" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="33.06" cy="20.40" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="33.06" cy="20.40" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="33.06" cy="20.40" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="33.06" cy="20.40" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="33.06" cy="20.40" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="33.06" cy="20.40" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="33.06" cy="20.40" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="33.06" cy="20.40" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="33.06" cy="20.40" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="33.06" cy="20.40" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="33.06" cy="20.40" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="33.06" cy="20.40" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="33.06" cy="20.40" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="33.06" cy="20.40" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="133.91" cy="20.40" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="133.91" cy="20.40" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="133.91" cy="20.40" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="133.91" cy="20.40" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="133.91" cy="20.40" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="133.91" cy="20.40" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="133.91" cy="20.40" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="133.91" cy="20.40" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="133.91" cy="20.40" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="133.91" cy="20.40" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="133.91" cy="20.40" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="133.91" cy="20.40" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="133.91" cy="20.40" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="133.91" cy="20.40" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="133.91" cy="20.40" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="133.91" cy="20.40" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="133.91" cy="20.40" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="133.91" cy="20.40" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="133.91" cy="20.40" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><line x1="83.48" y1="23.63" x2="83.48" y2="1.00" style="stroke-width: 1.07; stroke-linecap: butt;"></line></g><g clip-path="url(#cpMC4wMHwxNDEuNzN8MC4wMHwzNC4wMg==)"><polyline points="1.00,23.63 140.74,23.63 " style="stroke-width: 0.75;"></polyline><polyline points="34.05,26.47 34.05,23.63 " style="stroke-width: 0.75;"></polyline><polyline points="132.92,26.47 132.92,23.63 " style="stroke-width: 0.75;"></polyline><text x="34.05" y="33.29" text-anchor="middle" style="font-size: 6.00px; font-family: &quot;Arial&quot;;" textlength="10.80px" lengthadjust="spacingAndGlyphs">5.1</text><text x="132.92" y="33.29" text-anchor="middle" style="font-size: 6.00px; font-family: &quot;Arial&quot;;" textlength="10.80px" lengthadjust="spacingAndGlyphs">6.5</text></g>
</svg></td>
<td class="gt_row gt_right" headers="n_missing">9.5%</td>
<td class="gt_row gt_right" headers="Mean">5.9</td>
<td class="gt_row gt_right" headers="Median">5.8</td>
<td class="gt_row gt_right" headers="SD">0.4</td>
</tr>
<tr class="even">
<td class="gt_row gt_left gt_striped" headers="type"><svg aria-hidden="true" role="img" viewbox="0 0 640 512" style="height:20px;width:25px;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:#f18e2c;overflow:visible;position:relative;">
<path d="M576 0c17.7 0 32 14.3 32 32V480c0 17.7-14.3 32-32 32s-32-14.3-32-32V32c0-17.7 14.3-32 32-32zM448 96c17.7 0 32 14.3 32 32V480c0 17.7-14.3 32-32 32s-32-14.3-32-32V128c0-17.7 14.3-32 32-32zM352 224V480c0 17.7-14.3 32-32 32s-32-14.3-32-32V224c0-17.7 14.3-32 32-32s32 14.3 32 32zM192 288c17.7 0 32 14.3 32 32V480c0 17.7-14.3 32-32 32s-32-14.3-32-32V320c0-17.7 14.3-32 32-32zM96 416v64c0 17.7-14.3 32-32 32s-32-14.3-32-32V416c0-17.7 14.3-32 32-32s32 14.3 32 32z"></path>
</svg></td>
<td class="gt_row gt_left gt_striped" headers="name" style="font-weight: bold">WeightPRE_corrected</td>
<td class="gt_row gt_center gt_striped" headers="value"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" class="svglite" width="141.73pt" height="34.02pt" viewbox="0 0 141.73 34.02">
<defs>
<style type="text/css">    .svglite line, .svglite polyline, .svglite polygon, .svglite path, .svglite rect, .svglite circle {      fill: none;      stroke: #000000;      stroke-linecap: round;      stroke-linejoin: round;      stroke-miterlimit: 10.00;    }    .svglite text {      white-space: pre;    }  </style>
</defs><rect width="100%" height="100%" style="stroke: none; fill: none;"></rect><defs> <clippath id="cpMC4wMHwxNDEuNzN8MC4wMHwzNC4wMg=="> <rect x="0.00" y="0.00" width="141.73" height="34.02"></rect> </clippath></defs><g clip-path="url(#cpMC4wMHwxNDEuNzN8MC4wMHwzNC4wMg==)"></g><defs> <clippath id="cpMS4wMHwxNDAuNzR8MS4wMHwyMy42Mw=="> <rect x="1.00" y="1.00" width="139.74" height="22.64"></rect> </clippath></defs><g clip-path="url(#cpMS4wMHwxNDAuNzR8MS4wMHwyMy42Mw==)"><rect x="7.35" y="20.80" width="25.41" height="2.83" style="stroke-width: 1.07; stroke: #FFFFFF; stroke-linecap: butt; stroke-linejoin: miter; fill: #F8BB87;"></rect><rect x="32.76" y="15.15" width="25.41" height="8.49" style="stroke-width: 1.07; stroke: #FFFFFF; stroke-linecap: butt; stroke-linejoin: miter; fill: #F8BB87;"></rect><rect x="58.16" y="1.00" width="25.41" height="22.64" style="stroke-width: 1.07; stroke: #FFFFFF; stroke-linecap: butt; stroke-linejoin: miter; fill: #F8BB87;"></rect><rect x="83.57" y="3.83" width="25.41" height="19.81" style="stroke-width: 1.07; stroke: #FFFFFF; stroke-linecap: butt; stroke-linejoin: miter; fill: #F8BB87;"></rect><rect x="108.98" y="20.80" width="25.41" height="2.83" style="stroke-width: 1.07; stroke: #FFFFFF; stroke-linecap: butt; stroke-linejoin: miter; fill: #F8BB87;"></rect><circle cx="28.16" cy="20.80" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="28.16" cy="20.80" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="28.16" cy="20.80" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="28.16" cy="20.80" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="28.16" cy="20.80" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="28.16" cy="20.80" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="28.16" cy="20.80" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="28.16" cy="20.80" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="28.16" cy="20.80" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="28.16" cy="20.80" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="28.16" cy="20.80" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="28.16" cy="20.80" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="28.16" cy="20.80" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="28.16" cy="20.80" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="28.16" cy="20.80" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="28.16" cy="20.80" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="28.16" cy="20.80" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="28.16" cy="20.80" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="28.16" cy="20.80" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="28.16" cy="20.80" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="111.24" cy="20.80" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="111.24" cy="20.80" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="111.24" cy="20.80" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="111.24" cy="20.80" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="111.24" cy="20.80" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="111.24" cy="20.80" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="111.24" cy="20.80" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="111.24" cy="20.80" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="111.24" cy="20.80" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="111.24" cy="20.80" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="111.24" cy="20.80" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="111.24" cy="20.80" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="111.24" cy="20.80" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="111.24" cy="20.80" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="111.24" cy="20.80" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="111.24" cy="20.80" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="111.24" cy="20.80" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="111.24" cy="20.80" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="111.24" cy="20.80" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="111.24" cy="20.80" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><line x1="72.41" y1="23.63" x2="72.41" y2="1.00" style="stroke-width: 1.07; stroke-linecap: butt;"></line></g><g clip-path="url(#cpMC4wMHwxNDEuNzN8MC4wMHwzNC4wMg==)"><polyline points="1.00,23.63 140.74,23.63 " style="stroke-width: 0.75;"></polyline><polyline points="28.97,26.47 28.97,23.63 " style="stroke-width: 0.75;"></polyline><polyline points="110.43,26.47 110.43,23.63 " style="stroke-width: 0.75;"></polyline><text x="28.97" y="33.29" text-anchor="middle" style="font-size: 6.00px; font-family: &quot;Arial&quot;;" textlength="10.80px" lengthadjust="spacingAndGlyphs">110</text><text x="110.43" y="33.29" text-anchor="middle" style="font-size: 6.00px; font-family: &quot;Arial&quot;;" textlength="10.80px" lengthadjust="spacingAndGlyphs">260</text></g>
</svg></td>
<td class="gt_row gt_right gt_striped" headers="n_missing">4.8%</td>
<td class="gt_row gt_right gt_striped" headers="Mean">192.9</td>
<td class="gt_row gt_right gt_striped" headers="Median">190.0</td>
<td class="gt_row gt_right gt_striped" headers="SD">42.3</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="type"><svg aria-hidden="true" role="img" viewbox="0 0 640 512" style="height:20px;width:25px;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:#f18e2c;overflow:visible;position:relative;">
<path d="M576 0c17.7 0 32 14.3 32 32V480c0 17.7-14.3 32-32 32s-32-14.3-32-32V32c0-17.7 14.3-32 32-32zM448 96c17.7 0 32 14.3 32 32V480c0 17.7-14.3 32-32 32s-32-14.3-32-32V128c0-17.7 14.3-32 32-32zM352 224V480c0 17.7-14.3 32-32 32s-32-14.3-32-32V224c0-17.7 14.3-32 32-32s32 14.3 32 32zM192 288c17.7 0 32 14.3 32 32V480c0 17.7-14.3 32-32 32s-32-14.3-32-32V320c0-17.7 14.3-32 32-32zM96 416v64c0 17.7-14.3 32-32 32s-32-14.3-32-32V416c0-17.7 14.3-32 32-32s32 14.3 32 32z"></path>
</svg></td>
<td class="gt_row gt_left" headers="name" style="font-weight: bold">WeightPOST_corrected</td>
<td class="gt_row gt_center" headers="value"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" class="svglite" width="141.73pt" height="34.02pt" viewbox="0 0 141.73 34.02">
<defs>
<style type="text/css">    .svglite line, .svglite polyline, .svglite polygon, .svglite path, .svglite rect, .svglite circle {      fill: none;      stroke: #000000;      stroke-linecap: round;      stroke-linejoin: round;      stroke-miterlimit: 10.00;    }    .svglite text {      white-space: pre;    }  </style>
</defs><rect width="100%" height="100%" style="stroke: none; fill: none;"></rect><defs> <clippath id="cpMC4wMHwxNDEuNzN8MC4wMHwzNC4wMg=="> <rect x="0.00" y="0.00" width="141.73" height="34.02"></rect> </clippath></defs><g clip-path="url(#cpMC4wMHwxNDEuNzN8MC4wMHwzNC4wMg==)"></g><defs> <clippath id="cpMS4wMHwxNDAuNzR8MS4wMHwyMy42Mw=="> <rect x="1.00" y="1.00" width="139.74" height="22.64"></rect> </clippath></defs><g clip-path="url(#cpMS4wMHwxNDAuNzR8MS4wMHwyMy42Mw==)"><rect x="7.35" y="15.15" width="31.76" height="8.49" style="stroke-width: 1.07; stroke: #FFFFFF; stroke-linecap: butt; stroke-linejoin: miter; fill: #F8BB87;"></rect><rect x="39.11" y="6.66" width="31.76" height="16.98" style="stroke-width: 1.07; stroke: #FFFFFF; stroke-linecap: butt; stroke-linejoin: miter; fill: #F8BB87;"></rect><rect x="70.87" y="1.00" width="31.76" height="22.64" style="stroke-width: 1.07; stroke: #FFFFFF; stroke-linecap: butt; stroke-linejoin: miter; fill: #F8BB87;"></rect><rect x="102.63" y="15.15" width="31.76" height="8.49" style="stroke-width: 1.07; stroke: #FFFFFF; stroke-linecap: butt; stroke-linejoin: miter; fill: #F8BB87;"></rect><circle cx="12.32" cy="20.80" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="12.32" cy="20.80" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="12.32" cy="20.80" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="12.32" cy="20.80" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="12.32" cy="20.80" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="12.32" cy="20.80" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="12.32" cy="20.80" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="12.32" cy="20.80" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="12.32" cy="20.80" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="12.32" cy="20.80" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="12.32" cy="20.80" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="12.32" cy="20.80" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="12.32" cy="20.80" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="12.32" cy="20.80" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="12.32" cy="20.80" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="12.32" cy="20.80" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="12.32" cy="20.80" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="12.32" cy="20.80" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="12.32" cy="20.80" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="12.32" cy="20.80" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="118.81" cy="20.80" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="118.81" cy="20.80" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="118.81" cy="20.80" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="118.81" cy="20.80" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="118.81" cy="20.80" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="118.81" cy="20.80" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="118.81" cy="20.80" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="118.81" cy="20.80" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="118.81" cy="20.80" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="118.81" cy="20.80" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="118.81" cy="20.80" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="118.81" cy="20.80" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="118.81" cy="20.80" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="118.81" cy="20.80" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="118.81" cy="20.80" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="118.81" cy="20.80" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="118.81" cy="20.80" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="118.81" cy="20.80" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="118.81" cy="20.80" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="118.81" cy="20.80" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><line x1="78.22" y1="23.63" x2="78.22" y2="1.00" style="stroke-width: 1.07; stroke-linecap: butt;"></line></g><g clip-path="url(#cpMC4wMHwxNDEuNzN8MC4wMHwzNC4wMg==)"><polyline points="1.00,23.63 140.74,23.63 " style="stroke-width: 0.75;"></polyline><polyline points="13.37,26.47 13.37,23.63 " style="stroke-width: 0.75;"></polyline><polyline points="117.76,26.47 117.76,23.63 " style="stroke-width: 0.75;"></polyline><text x="13.37" y="33.29" text-anchor="middle" style="font-size: 6.00px; font-family: &quot;Arial&quot;;" textlength="10.80px" lengthadjust="spacingAndGlyphs">108</text><text x="117.76" y="33.29" text-anchor="middle" style="font-size: 6.00px; font-family: &quot;Arial&quot;;" textlength="10.80px" lengthadjust="spacingAndGlyphs">240</text></g>
</svg></td>
<td class="gt_row gt_right" headers="n_missing">4.8%</td>
<td class="gt_row gt_right" headers="Mean">182.2</td>
<td class="gt_row gt_right" headers="Median">190.0</td>
<td class="gt_row gt_right" headers="SD">35.9</td>
</tr>
<tr class="even">
<td class="gt_row gt_left gt_striped" headers="type"><svg aria-hidden="true" role="img" viewbox="0 0 512 512" style="height:20px;width:20px;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:#4e79a7;overflow:visible;position:relative;">
<path d="M40 48C26.7 48 16 58.7 16 72v48c0 13.3 10.7 24 24 24H88c13.3 0 24-10.7 24-24V72c0-13.3-10.7-24-24-24H40zM192 64c-17.7 0-32 14.3-32 32s14.3 32 32 32H480c17.7 0 32-14.3 32-32s-14.3-32-32-32H192zm0 160c-17.7 0-32 14.3-32 32s14.3 32 32 32H480c17.7 0 32-14.3 32-32s-14.3-32-32-32H192zm0 160c-17.7 0-32 14.3-32 32s14.3 32 32 32H480c17.7 0 32-14.3 32-32s-14.3-32-32-32H192zM16 232v48c0 13.3 10.7 24 24 24H88c13.3 0 24-10.7 24-24V232c0-13.3-10.7-24-24-24H40c-13.3 0-24 10.7-24 24zM40 368c-13.3 0-24 10.7-24 24v48c0 13.3 10.7 24 24 24H88c13.3 0 24-10.7 24-24V392c0-13.3-10.7-24-24-24H40z"></path>
</svg></td>
<td class="gt_row gt_left gt_striped" headers="name" style="font-weight: bold"><div style="max-width: 150px;">
<details style="font-weight: normal !important;">
<summary style="font-weight: bold !important;">
GenderCoded.f
</summary>
Male and Female
</details>
</div></td>
<td class="gt_row gt_center gt_striped" headers="value"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" class="svglite" width="141.73pt" height="34.02pt" viewbox="0 0 141.73 34.02">
<defs>
<style type="text/css">    .svglite line, .svglite polyline, .svglite polygon, .svglite path, .svglite rect, .svglite circle {      fill: none;      stroke: #000000;      stroke-linecap: round;      stroke-linejoin: round;      stroke-miterlimit: 10.00;    }    .svglite text {      white-space: pre;    }  </style>
</defs><rect width="100%" height="100%" style="stroke: none; fill: none;"></rect><defs> <clippath id="cpMC4wMHwxNDEuNzN8MC4wMHwzNC4wMg=="> <rect x="0.00" y="0.00" width="141.73" height="34.02"></rect> </clippath></defs><g clip-path="url(#cpMC4wMHwxNDEuNzN8MC4wMHwzNC4wMg==)"></g><defs> <clippath id="cpMS4wMHwxNDAuNzR8Mi45OXwyMy42MQ=="> <rect x="1.00" y="2.99" width="139.74" height="20.62"></rect> </clippath></defs><g clip-path="url(#cpMS4wMHwxNDAuNzR8Mi45OXwyMy42MQ==)"><rect x="81.90" y="3.93" width="58.84" height="18.75" style="stroke-width: 1.07; stroke: none; stroke-linecap: butt; stroke-linejoin: miter; fill: #DDEAF7;"></rect><rect x="1.00" y="3.93" width="80.90" height="18.75" style="stroke-width: 1.07; stroke: none; stroke-linecap: butt; stroke-linejoin: miter; fill: #3181BD;"></rect></g><g clip-path="url(#cpMC4wMHwxNDEuNzN8MC4wMHwzNC4wMg==)"><text x="1.00" y="30.18" style="font-size: 8.00px; font-family: &quot;Arial&quot;;" textlength="43.60px" lengthadjust="spacingAndGlyphs">2 categories</text></g>
</svg></td>
<td class="gt_row gt_right gt_striped" headers="n_missing">9.5%</td>
<td class="gt_row gt_right gt_striped" headers="Mean">—</td>
<td class="gt_row gt_right gt_striped" headers="Median">—</td>
<td class="gt_row gt_right gt_striped" headers="SD">—</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="type"><svg aria-hidden="true" role="img" viewbox="0 0 512 512" style="height:20px;width:20px;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:#4e79a7;overflow:visible;position:relative;">
<path d="M40 48C26.7 48 16 58.7 16 72v48c0 13.3 10.7 24 24 24H88c13.3 0 24-10.7 24-24V72c0-13.3-10.7-24-24-24H40zM192 64c-17.7 0-32 14.3-32 32s14.3 32 32 32H480c17.7 0 32-14.3 32-32s-14.3-32-32-32H192zm0 160c-17.7 0-32 14.3-32 32s14.3 32 32 32H480c17.7 0 32-14.3 32-32s-14.3-32-32-32H192zm0 160c-17.7 0-32 14.3-32 32s14.3 32 32 32H480c17.7 0 32-14.3 32-32s-14.3-32-32-32H192zM16 232v48c0 13.3 10.7 24 24 24H88c13.3 0 24-10.7 24-24V232c0-13.3-10.7-24-24-24H40c-13.3 0-24 10.7-24 24zM40 368c-13.3 0-24 10.7-24 24v48c0 13.3 10.7 24 24 24H88c13.3 0 24-10.7 24-24V392c0-13.3-10.7-24-24-24H40z"></path>
</svg></td>
<td class="gt_row gt_left" headers="name" style="font-weight: bold"><div style="max-width: 150px;">
<details style="font-weight: normal !important;">
<summary style="font-weight: bold !important;">
SES.f
</summary>
average income, low income and high income
</details>
</div></td>
<td class="gt_row gt_center" headers="value"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" class="svglite" width="141.73pt" height="34.02pt" viewbox="0 0 141.73 34.02">
<defs>
<style type="text/css">    .svglite line, .svglite polyline, .svglite polygon, .svglite path, .svglite rect, .svglite circle {      fill: none;      stroke: #000000;      stroke-linecap: round;      stroke-linejoin: round;      stroke-miterlimit: 10.00;    }    .svglite text {      white-space: pre;    }  </style>
</defs><rect width="100%" height="100%" style="stroke: none; fill: none;"></rect><defs> <clippath id="cpMC4wMHwxNDEuNzN8MC4wMHwzNC4wMg=="> <rect x="0.00" y="0.00" width="141.73" height="34.02"></rect> </clippath></defs><g clip-path="url(#cpMC4wMHwxNDEuNzN8MC4wMHwzNC4wMg==)"></g><defs> <clippath id="cpMS4wMHwxNDAuNzR8Mi45OXwyMy42MQ=="> <rect x="1.00" y="2.99" width="139.74" height="20.62"></rect> </clippath></defs><g clip-path="url(#cpMS4wMHwxNDAuNzR8Mi45OXwyMy42MQ==)"><rect x="118.67" y="3.93" width="22.06" height="18.75" style="stroke-width: 1.07; stroke: none; stroke-linecap: butt; stroke-linejoin: miter; fill: #DDEAF7;"></rect><rect x="89.25" y="3.93" width="29.42" height="18.75" style="stroke-width: 1.07; stroke: none; stroke-linecap: butt; stroke-linejoin: miter; fill: #91B4DA;"></rect><rect x="1.00" y="3.93" width="88.26" height="18.75" style="stroke-width: 1.07; stroke: none; stroke-linecap: butt; stroke-linejoin: miter; fill: #3181BD;"></rect></g><g clip-path="url(#cpMC4wMHwxNDEuNzN8MC4wMHwzNC4wMg==)"><text x="1.00" y="30.18" style="font-size: 8.00px; font-family: &quot;Arial&quot;;" textlength="43.60px" lengthadjust="spacingAndGlyphs">3 categories</text></g>
</svg></td>
<td class="gt_row gt_right" headers="n_missing">9.5%</td>
<td class="gt_row gt_right" headers="Mean">—</td>
<td class="gt_row gt_right" headers="Median">—</td>
<td class="gt_row gt_right" headers="SD">—</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<hr />
<div style="page-break-after: always;"></div>
</section>
<section id="other-places-to-get-help-and-get-started" class="level2">
<h2>5. Other Places to Get Help and Get Started</h2>
<ul>
<li>See the summary of graphics resources at <a href="./additionalResources.html#r-graphics">Additional Resources - R Graphics</a></li>
</ul>
<hr />
</section>
<section id="r-code-for-this-module" class="level2">
<h2>R Code For This Module</h2>
<ul>
<li><a href=""><code>module_133.R</code></a></li>
</ul>
</section>
<section id="references" class="level2">
<h2>References</h2>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-R-gt" class="csl-entry" role="listitem">
Iannone, Richard, Joe Cheng, Barret Schloerke, Ellis Hughes, Alexandra Lauer, JooYoung Seo, Ken Brevoort, and Olivier Roy. 2024. <em>Gt: Easily Create Presentation-Ready Display Tables</em>. <a href="https://gt.rstudio.com">https://gt.rstudio.com</a>.
</div>
<div id="ref-R-ggpubr" class="csl-entry" role="listitem">
Kassambara, Alboukadel. 2023. <em>Ggpubr: Ggplot2 Based Publication Ready Plots</em>. <a href="https://rpkgs.datanovia.com/ggpubr/">https://rpkgs.datanovia.com/ggpubr/</a>.
</div>
<div id="ref-vcd2006" class="csl-entry" role="listitem">
Meyer, David, Achim Zeileis, and Kurt Hornik. 2006. <span>“The Strucplot Framework: Visualizing Multi-Way Contingency Tables with Vcd.”</span> <em>Journal of Statistical Software</em> 17 (3): 1–48. <a href="https://doi.org/10.18637/jss.v017.i03">https://doi.org/10.18637/jss.v017.i03</a>.
</div>
<div id="ref-R-vcd" class="csl-entry" role="listitem">
Meyer, David, Achim Zeileis, Kurt Hornik, and Michael Friendly. 2023. <em>Vcd: Visualizing Categorical Data</em>. <a href="https://CRAN.R-project.org/package=vcd">https://CRAN.R-project.org/package=vcd</a>.
</div>
<div id="ref-R-gtExtras" class="csl-entry" role="listitem">
Mock, Thomas. 2024. <em>gtExtras: Extending Gt for Beautiful HTML Tables</em>. <a href="https://github.com/jthomasmock/gtExtras">https://github.com/jthomasmock/gtExtras</a>.
</div>
<div id="ref-R-patchwork" class="csl-entry" role="listitem">
Pedersen, Thomas Lin. 2024. <em>Patchwork: The Composer of Plots</em>. <a href="https://patchwork.data-imaginist.com">https://patchwork.data-imaginist.com</a>.
</div>
<div id="ref-R-base" class="csl-entry" role="listitem">
R Core Team. 2024. <em>R: A Language and Environment for Statistical Computing</em>. Vienna, Austria: R Foundation for Statistical Computing. <a href="https://www.R-project.org/">https://www.R-project.org/</a>.
</div>
<div id="ref-R-GGally" class="csl-entry" role="listitem">
Schloerke, Barret, Di Cook, Joseph Larmarange, Francois Briatte, Moritz Marbach, Edwin Thoen, Amos Elberg, and Jason Crowley. 2024. <em>GGally: Extension to Ggplot2</em>. <a href="https://ggobi.github.io/ggally/">https://ggobi.github.io/ggally/</a>.
</div>
<div id="ref-plotly2020" class="csl-entry" role="listitem">
Sievert, Carson. 2020. <em>Interactive Web-Based Data Visualization with r, Plotly, and Shiny</em>. Chapman; Hall/CRC. <a href="https://plotly-r.com">https://plotly-r.com</a>.
</div>
<div id="ref-R-plotly" class="csl-entry" role="listitem">
Sievert, Carson, Chris Parmer, Toby Hocking, Scott Chamberlain, Karthik Ram, Marianne Corvellec, and Pedro Despouy. 2024. <em>Plotly: Create Interactive Web Graphics via Plotly.js</em>. <a href="https://plotly-r.com">https://plotly-r.com</a>.
</div>
<div id="ref-ggplot22016" class="csl-entry" role="listitem">
Wickham, Hadley. 2016. <em>Ggplot2: Elegant Graphics for Data Analysis</em>. Springer-Verlag New York. <a href="https://ggplot2.tidyverse.org">https://ggplot2.tidyverse.org</a>.
</div>
<div id="ref-R-ggplot2" class="csl-entry" role="listitem">
Wickham, Hadley, Winston Chang, Lionel Henry, Thomas Lin Pedersen, Kohske Takahashi, Claus Wilke, Kara Woo, Hiroaki Yutani, Dewey Dunnington, and Teun van den Brand. 2024. <em>Ggplot2: Create Elegant Data Visualisations Using the Grammar of Graphics</em>. <a href="https://ggplot2.tidyverse.org">https://ggplot2.tidyverse.org</a>.
</div>
<div id="ref-R-dplyr" class="csl-entry" role="listitem">
Wickham, Hadley, Romain François, Lionel Henry, Kirill Müller, and Davis Vaughan. 2023. <em>Dplyr: A Grammar of Data Manipulation</em>. <a href="https://dplyr.tidyverse.org">https://dplyr.tidyverse.org</a>.
</div>
<div id="ref-vcd2007" class="csl-entry" role="listitem">
Zeileis, Achim, David Meyer, and Kurt Hornik. 2007. <span>“Residual-Based Shadings for Visualizing (Conditional) Independence.”</span> <em>Journal of Computational and Graphical Statistics</em> 16 (3): 507–25. <a href="https://doi.org/10.1198/106186007X237856">https://doi.org/10.1198/106186007X237856</a>.
</div>
</div>
</section>
<section id="other-helpful-resources" class="level2">
<h2>Other Helpful Resources</h2>
<p><a href="./additionalResources.html"><strong>Other Helpful Resources</strong></a></p>
<div id="quarto-navigation-envelope" class="hidden">
<p><span class="hidden quarto-markdown-envelope-contents" data-render-id="cXVhcnRvLWludC1zaWRlYmFyLXRpdGxl">R Training - TIDAL Lectures</span> <span class="hidden quarto-markdown-envelope-contents" data-render-id="cXVhcnRvLWludC1uYXZiYXItdGl0bGU=">R Training - TIDAL Lectures</span> <span class="hidden quarto-markdown-envelope-contents" data-render-id="cXVhcnRvLWludC1uZXh0">1.3.4: Missing Data and Sampling Weights</span> <span class="hidden quarto-markdown-envelope-contents" data-render-id="cXVhcnRvLWludC1wcmV2">1.3.2: Data Wrangling</span> <span class="hidden quarto-markdown-envelope-contents" data-render-id="cXVhcnRvLWludC1zaWRlYmFyOi9pbmRleC5odG1sSG9tZQ==">Home</span> <span class="hidden quarto-markdown-envelope-contents" data-render-id="cXVhcnRvLWludC1zaWRlYmFyOi9tb2R1bGUxMzFfSW50cm9SUlN0dWRpby5odG1sMS4zLjE6LUludHJvZHVjdGlvbi10by1SLWFuZC1SLVN0dWRpbw==">1.3.1: Introduction to R and R Studio</span> <span class="hidden quarto-markdown-envelope-contents" data-render-id="cXVhcnRvLWludC1zaWRlYmFyOi9tb2R1bGUxMzJfRGF0YVdyYW5nbGluZy5odG1sMS4zLjI6LURhdGEtV3JhbmdsaW5n">1.3.2: Data Wrangling</span> <span class="hidden quarto-markdown-envelope-contents" data-render-id="cXVhcnRvLWludC1zaWRlYmFyOi9tb2R1bGUxMzNfRGF0YVZpcy5odG1sMS4zLjM6LURhdGEtVmlzdWFsaXphdGlvbg==">1.3.3: Data Visualization</span> <span class="hidden quarto-markdown-envelope-contents" data-render-id="cXVhcnRvLWludC1zaWRlYmFyOi9tb2R1bGUxMzRfTWlzc2luZ1dlaWdodC5odG1sMS4zLjQ6LU1pc3NpbmctRGF0YS1hbmQtU2FtcGxpbmctV2VpZ2h0cw==">1.3.4: Missing Data and Sampling Weights</span> <span class="hidden quarto-markdown-envelope-contents" data-render-id="cXVhcnRvLWludC1zaWRlYmFyOi9tb2R1bGUxMzVfU3RhdGlzdGljYWxUZXN0cy5odG1sMS4zLjU6LVN0YXRpc3RpY2FsLVRlc3RzLWFuZC1Nb2RlbHM=">1.3.5: Statistical Tests and Models</span> <span class="hidden quarto-markdown-envelope-contents" data-render-id="cXVhcnRvLWludC1zaWRlYmFyOi9tb2R1bGUxMzZfUmVwcm9kdWNpYmxlUmVzZWFyY2guaHRtbDEuMy42Oi1SZXByb2R1Y2libGUtUmVzZWFyY2gtUHJpbmNpcGxlcw==">1.3.6: Reproducible Research Principles</span> <span class="hidden quarto-markdown-envelope-contents" data-render-id="cXVhcnRvLWludC1zaWRlYmFyOi9QUkFNUy5odG1sUFJBTVMtRGF0YS1BbmFseXNpcw==">PRAMS Data Analysis</span> <span class="hidden quarto-markdown-envelope-contents" data-render-id="cXVhcnRvLWludC1zaWRlYmFyOi9hZGRpdGlvbmFsUmVzb3VyY2VzLmh0bWxBZGRpdGlvbmFsLUhlbHAtYW5kLVJlc291cmNlcw==">Additional Help and Resources</span> <span class="hidden quarto-markdown-envelope-contents" data-render-id="cXVhcnRvLWJyZWFkY3J1bWJzLTEuMy4zOi1EYXRhLVZpc3VhbGl6YXRpb24=">1.3.3: Data Visualization</span></p>
<div class="hidden quarto-markdown-envelope-contents" data-render-id="Zm9vdGVyLWxlZnQ=">
<p><a href="https://creativecommons.org/licenses/by-nc-nd/4.0/"><img src="https://img.shields.io/badge/License-CC_BY--NC--ND_4.0-lightgrey.svg" class="img-fluid" /></a></p>
</div>
<div class="hidden quarto-markdown-envelope-contents" data-render-id="Zm9vdGVyLWNlbnRlcg==">
<p>Copyright 2025, <a href="https://melindahiggins.netlify.app/">Melinda Higgins, PhD.</a> <a href="https://www.linkedin.com/in/melindahiggins2000/"><i class="fa-brands fa-linkedin" aria-label="linkedin"></i></a> <a href="https://scholar.google.com/citations?user=-4aU-VkAAAAJ&amp;hl=en"><i class="fa-brands fa-google-scholar" aria-label="google-scholar"></i></a> <a href="https://github.com/melindahiggins2000"><i class="fa-brands fa-github" aria-label="github"></i></a> <a href="mailto:mkhiggi@emory.edu"><i class="fa-solid fa-envelope" aria-label="envelope"></i></a></p>
</div>
</div>
<div id="quarto-meta-markdown" class="hidden">
<p><span class="hidden quarto-markdown-envelope-contents" data-render-id="cXVhcnRvLW1ldGF0aXRsZQ==">1.3.3: Data Visualization – R Training - TIDAL Lectures</span> <span class="hidden quarto-markdown-envelope-contents" data-render-id="cXVhcnRvLXR3aXR0ZXJjYXJkdGl0bGU=">1.3.3: Data Visualization – R Training - TIDAL Lectures</span> <span class="hidden quarto-markdown-envelope-contents" data-render-id="cXVhcnRvLW9nY2FyZHRpdGxl">1.3.3: Data Visualization – R Training - TIDAL Lectures</span> <span class="hidden quarto-markdown-envelope-contents" data-render-id="cXVhcnRvLW1ldGFzaXRlbmFtZQ==">R Training - TIDAL Lectures</span> <span class="hidden quarto-markdown-envelope-contents" data-render-id="cXVhcnRvLXR3aXR0ZXJjYXJkZGVzYw==">(Asynchronous-Online)</span> <span class="hidden quarto-markdown-envelope-contents" data-render-id="cXVhcnRvLW9nY2FyZGRkZXNj">(Asynchronous-Online)</span></p>
</div>
</section>

</main> <!-- /main -->
<script id = "quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/emorytidal\.netlify\.app\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      <div class='footer-contents'>[![](https://img.shields.io/badge/License-CC_BY--NC--ND_4.0-lightgrey.svg)](https://creativecommons.org/licenses/by-nc-nd/4.0/)</div>  
    </div>   
    <div class="nav-footer-center">
      <div class='footer-contents'>Copyright 2025, [Melinda Higgins, PhD.](https://melindahiggins.netlify.app/) [](https://www.linkedin.com/in/melindahiggins2000/)  [](https://scholar.google.com/citations?user=-4aU-VkAAAAJ&hl=en)  [](https://github.com/melindahiggins2000)  [](mailto:mkhiggi@emory.edu)</div>  
    </div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>

</body>

</html>
