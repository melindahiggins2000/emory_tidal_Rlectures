---
title: "1.3.3: Data Visualization"
subtitle: "(Asynchronous-Online)"
bibliography: ./packages.bib
nocite: |
  @*
format:
  html: default
  pdf: default
editor_options: 
  chunk_output_type: console
---

\thispagestyle{fancy}

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE,
                      error = TRUE,
                      message = FALSE,
                      warning = FALSE)
```

## Session Objectives

1. To visualize data using different R packages.

Key points to cover:

1. Introduce to ggplot2 and other R packages.
2. Visualize one, two, or more variables at a time.
3. Introduce other resources (e.g., books, blogs, or websites) trainees can refer to.

---

## 0. Prework - Before You Begin

### A. Install packages

If you do not have them already, install the following packages from CRAN:

* [`ggplot2](https://cloud.r-project.org/web/packages/ggplot2/)
* [`ggthemes`](https://cloud.r-project.org/web/packages/ggthemes/)
* [`readr`](https://cloud.r-project.org/web/packages/readr/)

### B. Open/create your RStudio project

Let's start with the `myfirstRproject` RStudio project you created in [Module 1.3.2 - part 1](module132_DataWrangling.html#begin-with-a-new-rstudio-project). If you have not yet created this `myfirstRproject` RStudio project, go ahead and create a new RStudio Project for this lesson. _Feel free to name your project whatever you want, it does not need to be named `myfirstRproject`._

### C. Create a new R script and load data into your computing session

At the end of [Module 1.3.2 - part 6](module132_DataWrangling.html#save-mydata-as-.rdata-native-r-binary-format) you saved the `mydata` dataset in the `mydata.RData` R binary format.

1. Go ahead and create a new R script (`*.R`) for this computing session. _We did this already in [Module 1.3.1 - part 3](module131_IntroRRStudio.html#create-your-first-r-script) - refer to this section to remember how to create a new R script._

2. Put this code into your new R script (`*.R`) to load `mydata.RData` into your current computing session.

```{r}
# load mydata
load(file = "mydata.RData")
```

::: callout-important
## Data must/should be in your RStudio project

**REMEMBER** R/RStudio automatically looks in your current RStudio project folder for all files for your current computing session. So, make sure the `mydata.RData` file is in your current RStudio project `myfirstRproject` folder on your computer.

\medskip

For a more detailed overview of RStudio projects:

* read ["Chapter 6: R projects" in the _The Epidemiologist R Handbook_](https://epirhandbook.com/en/new_pages/r_projects.html) and 
* refer to ["Chapter 45 Directory interactions" in the _The Epidemiologist R Handbook_ ](https://epirhandbook.com/en/new_pages/directories.html).
:::

### D. Get Inspired!

* Get Inspired at [The R Graph Gallery](https://r-graph-gallery.com/)
* Also see the [Top Curated R Graphs](https://r-graph-gallery.com/best-r-chart-examples)
* Also see [Additional Resources - R Graphics](additionalResources.html#r-graphics)

---

\newpage

## 1. Base R graphical functions

The base R `graphics` package is very powerful on its own. As you saw in [1.3.1: Introduction to R and R Studio](module131_IntroRRStudio.html), we can make a simple 2-dimensional scatterplot with the `plot()` function.

### Base R - Scatterplot

For example, let's make a plot of `Height` on the X-axis (horizontal) and `WeightPRE` on the Y-axis (vertical) from the `mydata` dataset. Since we are using base R function, we have to use the `$`selector to identify the variables we want inside the `mydata` dataset.

Learn more about the `plot()` function and arguments by running `help(plot, package = "graphics")`.

```{r}
plot(x = mydata$Height,
     y = mydata$WeightPRE)
```

The plot does look a little odd - this is due to some data errors in the `mydata` dataset. We will fix these below. But for now, you can "see" that these data may have some issues that need to be addressed. For example:

* There are 2 people with heights < 5 feet tall which may be suspect
* There are 2 people with a weight < 100 pounds which may be data entry errors or incorrect units

For now, let's add some additional graphical elements:

* a better label for the x-axis
* a better label for the y-axis
* a title for the graph
* a subtitle for the graph

```{r}
plot(x = mydata$Height,
     y = mydata$WeightPRE,
     xlab = "Height (in decimal inches)",
     ylab = "Weight (in pounds) - before intervention",
     main = "Weight by Height in the Mydata Project",
     sub = "Hypothetical Madeup mydata Dataset")
```

And we could also add color and change the shapes - for example, let's color and shape the points by `GenderCoded`, the numeric coding for gender where 1=Male, 2=Female.

::: callout-note
## Plot code inspiration

I pulled this code together from code examples at:

* [Stackoverflow post on using `pch`](https://stackoverflow.com/questions/12919816/plotting-in-different-shapes-using-pch-argument)
* [STHDA post on point shapes](https://www.sthda.com/english/wiki/r-plot-pch-symbols-the-different-point-shapes-available-in-r)
:::

```{r}
plot(x = mydata$Height,
     y = mydata$WeightPRE,
     col = c("blue", "green")[mydata$GenderCoded],
     pch = c(15, 19)[mydata$GenderCoded],
     xlab = "Height (in decimal inches)",
     ylab = "Weight (in pounds) - before intervention",
     main = "Weight by Height in the Mydata Project",
     sub = "Hypothetical Madeup mydata Dataset")
```

The [STHDA website on "R Base Graphs" ](https://www.sthda.com/english/wiki/r-base-graphs) has a nice walkthrough of using the base R `graphics` package to make really nice plots.

### Base R - Histogram

As we noted above, let's take a look at the distribution of the heights in the `mydata` dataset. There is a specific `hist()` function in the `graphics` package for making histograms, learn more by running `help(hist, package = "graphics")`.

Notice that we can use some of the same arguments as we did above for `plot()`.


```{r}
hist(mydata$Height,
     xlab = "Height (in decimal inches)",
     col = "lightblue",
     border = "black",
     main = "Histogram of Heights",
     sub = "Hypothetical Madeup mydata Dataset")
```

::: callout-tip
## Colors available

There are 657 names colors immediately available to you from the built-in `grDevices` Base R package which works in conjunction with `graphics`. You can view the names of all of these colors by running `colors()`. You can also learn more at:

* [https://www.sthda.com/english/wiki/colors-in-r#google_vignette](https://www.sthda.com/english/wiki/colors-in-r#google_vignette)
* [https://r-graph-gallery.com/42-colors-names.html](https://r-graph-gallery.com/42-colors-names.html)
* [https://r-graph-gallery.com/ggplot2-color.html](https://r-graph-gallery.com/ggplot2-color.html) - which explains how colors can be specified using the built-in color names, but cal also be specified using RGB (red, green, blue) indexes or even Hexcodes for which there are many online tools like [https://htmlcolorcodes.com/](https://htmlcolorcodes.com/).
:::

```{r}
# list built-in colors
colors()
```

**Overlay a Density Curve**

Statisticians often like seeing a histogram _(for the frequencies or probability of each value for the variable in the dataset)_ with an overlaid density curve _(which is "smoothed" line for these probabilities)_. Statistical software like SAS and SPSS make this really easy. However, in R, we need to think through the process to get this to work.

* First, we need to make the histogram using probabilities for the "bars" in the histogram instead of frequency counts.
* Second, we need to add a density line curve over the histogram "bars".

See these online examples:

* [https://r-charts.com/distribution/histogram-curves/](https://r-charts.com/distribution/histogram-curves/)
* [https://www.datacamp.com/doc/r/histograms-and-density](https://www.datacamp.com/doc/r/histograms-and-density)
* [https://www.r-bloggers.com/2012/09/histogram-density-plot-combo-in-r/](https://www.r-bloggers.com/2012/09/histogram-density-plot-combo-in-r/)

```{r}
# make histogram as we did above
# add freq = FALSE
hist(mydata$Height,
     freq = FALSE,
     xlab = "Height (in decimal inches)",
     col = "lightblue",
     border = "black",
     main = "Histogram of Heights",
     sub = "Hypothetical Madeup mydata Dataset")

# add density curve line
# add na.rm=TRUE to remove 
# the missing values in Height
lines(density(mydata$Height, na.rm=TRUE),
      col = "black")
```



### Base R - Barchart



### Base R - Boxplot





---

\newpage

## 2. `ggplot2` package

The `ggplot2` package name starts with `gg` which stands for the "grammar of graphics" which is explained in the ["ggplot2: Elegant Graphics for Data Analysis (3e)" Book](https://ggplot2-book.org/introduction#what-is-the-grammar-of-graphics). 

::: callout-note
## Why is the package `ggplot2` and not `ggplot`? 

Many people often ask Hadley Wickham (the developer of `ggplot2`) what happened to the first `ggplot`? Technically, there was a `ggplot` package and you can still view the [`ggplot` archived package versions on CRAN](https://cran.r-project.org/src/contrib/Archive/ggplot/) which date back to 2006 with the last version posted in 2008. However, in 2007, Hadley redesigned the package and published the first version of [`ggplot2` _(version 0.5.1)_ was posted on CRAN](https://cran.r-project.org/src/contrib/Archive/ggplot2/). So, `ggplot2` is the package that has stayed in production and actively maintained for nearly 20 years!!
:::


Given that `ggplot2` has been actively maintained for nearly 20 years, it has become _almost_ the defacto graphical standard for R graphics. If you take a look at the [list of packages on CRAN that start with the letter "G"](https://cran.r-project.org/web/packages/available_packages_by_name.html#available-packages-G), as of this morning `01/28/2025 at 8:23 am EST, USA`, there are 230 packages that start with `gg` - nearly all of these are compatible packages that extend the functionality or work in concert with the `ggplot2` package. There are also currently 14 packages on the [Bioconductor repository](https://www.bioconductor.org/packages/release/BiocViews.html#___Software) that start with `gg`.



### `ggplot2` - Scatterplot



### `ggplot2` - Histogram



### `ggplot2` - Barchart



### `ggplot2` - Boxplot



---

\newpage

## 3. Get boilerplate code to start

### R Gallery


### R Graphics Cookbook






---

\newpage

```{r echo=FALSE}
knitr::write_bib(x = c(.packages()), 
                 file = "packages.bib")
```

## References

::: {#refs}
:::

## Other Helpful Resources

[**Other Helpful Resources**](./additionalResources.html)

